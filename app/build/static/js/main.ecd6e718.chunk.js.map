{"version":3,"sources":["components/header/AppHeader.jsx","components/footer/Footer.jsx","components/linechart/LineChart.jsx","components/linechart/SmallLineChart.jsx","components/drawsignal/DrawSignal.jsx","components/viz/Viz.jsx","components/helperfunctions/HelperFunctions.jsx","components/rocchart/ROCChart.jsx","components/histogram/HistogramChart.jsx","components/scatterplot/ScatterPlot.jsx","components/losschart/LossChart.jsx","components/composemodel/ComposeModel.jsx","components/train/models/ae.jsx","components/train/Train.jsx","components/faq/Faq.jsx","components/Main.jsx","serviceWorker.js","index.js"],"names":["AppHeader","props","appName","appDescription","aria-label","this","prefix","className","src","alt","role","tabIndex","exact","to","Component","Footer","style","zIndex","href","target","LineChart","state","data","predictedData","color","minChartWidth","width","minChartHeight","height","backgrounOpacity","drawGraph","prevProps","prevState","lastUpdated","setState","updateGraph","chartMargin","top","right","bottom","left","chartWidth","chartHeight","n","length","xScale","d3","domain","range","yScale","xAxis","yAxis","tickSize","self","setupScalesAxes","concat","svg","transition","jointData","i","push","select","duration","attr","line","predictedColor","msearea","call","g","remove","selectAll","margin","x","d","y","y0","Math","min","y1","max","dataset","append","datum","ref","backgroundColor","SmallLineChart","chart","miniChartWidth","miniChartHeight","canvas","refs","smalllinecanvas","context","getContext","translate","scale","strokeStyle","prev_stat","move_left_by","stat","the_stat","beginPath","moveTo","lineTo","lineWidth","lineCap","stroke","DrawSignal","signalExtracted","axisOffset","smallChartWidth","smallChartHeight","prevX","currX","prevY","currY","dot_flag","strokeColor","flag","drawMap","Map","signalCount","pointColors","scaleRange","axisList","setUpCanvasSize","drawsignaloutcanvas","smallChartContext","largeChartCanvas","drawsignalcanvas","largeChartContext","addEventListener","mouseDownEvent","bind","mouseUpEvent","mouseMoveEvent","mouseOutEvent","touchEndEvent","touchStartEvent","passive","touchMoveEvent","ynScale","zeroArr","Array","fill","closePath","has","set","res","e","fillStyle","fillRect","miniGraph","xPos","yPos","limitValues","setXYCoords","draw","console","log","changedTouches","pageY","pageX","offsetLeft","offsetTop","findxy","updateMove","removeEventListener","size","clearRect","updateCurrentSignal","start","end","prevMean","sum","count","get","rangeMean","values","next","value","curMean","signalHolder","signalHolderScaled","step","floor","xaxis","map","key","id","Button","renderIcon","onClick","clearDrawing","drawSample","Viz","modelChartWidth","window","innerWidth","modelChartHeight","testData","require","slice","apptitle","trainData","selectedIndex","selectedData","showDrawData","drawSectionWidth","drawSectionHeight","isLoading","modelLoaded","threshold","predictedMse","selectedLegend","loadData","chartColorMap","0","colornorm","name","1","2","4","5","maxSmallChart","modelDataLastUpdated","offsetWidth","xMinArray","xMaxArray","featureRange","loadedModel","dispose","holder","setTimeout","tf","then","model","getPrediction","transformedData","applyTransform","dataTensor","preds","predict","batchSize","square","mean","mse","array","applyReverseTransform","loadModel","getAttribute","setSelectedData","index","dataLegend","Object","entries","action","clickLegend","background","dataPoints","isVisible","clickDataPoint","indexvalue","targetval","datasetExamples","dataSketchPad","barColor","modelOutput","opacity","Loading","active","small","withOverlay","toFixed","setDatasetECG","setDatasetDraw","rel","computeAccuracyGivenThreshold","predVal","truePositive","trueNegative","falsePositive","falseNegative","forEach","each","label","acc","tp","tn","fp","fn","tpr","fpr","fnr","tnr","percentToRGB","percent","r","LeaderLine","animOptions","timing","ROCChart","numTicks","dotRadius","epoch","animationDuration","rocLine","rocArea","join","drawLines","text","auc","HistogramChart","nice","bins","thresholds","ticks","binNorm","binsAnorm","x0","x1","meanNormal","meanAbnormal","midPoint","ScatterPlot","LossChart","innerHTML","loss","val_loss","trainLine","valLine","curve","ComposeModel","hiddenDims","latentDim","maxLayers","minLayers","maxUnits","minUnits","defaultLayerDim","isTraining","latentLineWidth","lineHolder","rightTopAnchor","rightBottomAnchor","leftTopAnchor","leftBottomAnchor","rightMiddle","leftMiddle","blueColor","greyColor","drawAllLines","network","attributeName","attributeValue","document","querySelector","layer","startId","endId","startEl","getElement","endEl","params","pathType","drawLeaderLine","latentDiv","getElementById","addLayerLines","addEncDecLines","lineId","toRemove","position","newHolder","startElement","endElement","startAnchor","endAnchor","lineColor","pointAnchor","startPlug","endPlug","startPlugColor","path","hide","dash","gap","show","opt","setOptions","redrawLine","updateModelDims","removeLayerLines","animateLines","adv","redrawAllLines","removeAllLines","varGroup","newDims","decoderDims","dimType","currentDims","getDims","setStateVal","pop","currentUnit","latentLayers","layerindex","eachLayer","_","unitindex","layergroup","buttonaction","updateUnits","encLayers","nodeunit","layerdiv","decLayers","updateLayerClick","Train","stepOptions","type","regularizerOptions","batchSizeOptions","learningRateOptions","trainingDataOptions","testDataOptions","optimizerOptions","abnormalPercentageOptions","selectedAbnormalPercentage","selectedTrainDataOption","selectedTestDataOption","selectedOptimizer","selectedRegularizer","trainMetricHolder","CumulativeSteps","trainDataShape","testDataShape","mseData","rocData","createdModel","encodedData","currentEpoch","numFeatures","hiddenLayers","hiddenDim","learningRate","regularizer","adamBeta1","optimizer","outputActivation","numSteps","numEpochs","trainMetrics","trainDataSize","testDataSize","modelStale","bestMetric","minThreshold","maxThreshold","showModelComposer","showModelEvaluationMetrics","showRocChart","showLossChart","showMseHistogram","showBottleneckScatterPlot","validateOnStep","showAdvanced","showIntroduction","showWarmingUp","lossChartHeight","lossChartWidth","abnormalPercentage","floatCapable","floatEnabled","isCreating","showOptions","checked","currentSteps","xsTrain","xsTest","yTest","trainDataPath","testDataPath","momentum","modelWarmedUp","tensorsCreated","trainUnmounted","getChartContainerSizes","computeAccuracyMetrics","generateDataTensors","destroyModelTensors","adam","adamax","adadelta","rmsprop","sgd","modelParams","regularizationRate","layerRegularizer","regularizers","l1","l2","l1l2","input","shape","encoderHidden","layers","dense","units","activation","kernelRegularizer","apply","z_","encoder","inputs","outputs","latentInput","decoderHidden","j","decoderOutput","output","ae","compile","buildModel","getPredictions","warmUpTensor","item","startTime","Date","fit","epochs","verbose","elapsedTime","validationData","metricRow","history","traintime","trainModel","savedModel","loadTestData","uniqueMse","sortBy","reverse","rocMetricHolder","rocSum","prevMetric","metric","mseDataHolder","element","getLayer","getOutputAt","encoderPredictions","encPredHolder","maxAbnormalCount","abnormalCount","trainEcg","row","val","createModel","selectedItem","threshVal","offsetHeight","chartState","box","showCheckBoxes","Checkbox","defaultChecked","wrapperClassName","labelText","showOptionsClick","trainResetButtons","resetModelButtonClick","trainButtonClick","configBar","Dropdown","items","initialSelectedItem","itemToString","onChange","updateModelParam","firstEncode","compBoxSize","modelComposerBlock","lossChartBlock","rocChartBlock","mseHistogramBlock","bottleneckScatterPlotBlock","modelMetricsBlock","Slider","minLabel","maxLabel","stepMuliplier","disabled","hideTextInput","updateThreshold","borderLeftColor","toggleIntroDrawer","toggleAdvancedDrawer","Tooltip","direction","triggerText","toString","Faq","metricData","createBrowserHistory","basename","forceRefresh","keyLength","getUserConfirmation","message","callback","confirm","linkHolder","updateLh","location","hash","listen","Main","component","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","error","ReactDOM","render","URL","process","origin","fetch","response","contentType","headers","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.ecd6e718.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport {\n    Header,\n    HeaderName,\n    HeaderNavigation,\n    // Link,\n    // HeaderMenuItem,\n    HeaderGlobalBar,\n    HeaderGlobalAction,\n    SkipToContent,\n} from 'carbon-components-react/lib/components/UIShell';\nimport {\n    NavLink\n} from \"react-router-dom\";\n\nimport \"./header.css\"\n// import Notification20 from '@carbon/icons-react/lib/notification/20';\n// import UserAvatar20 from '@carbon/icons-react/lib/user--avatar/20';\nimport AppSwitcher20 from '@carbon/icons-react/lib/app-switcher/20';\n\nclass AppHeader extends Component {\n    constructor(props) {\n        super(props)\n\n        this.appName = \"Anomagram\"\n        this.appDescription = \"An interactive visualization for exploring deep learning models applied to the task of anomaly detection.\"\n\n\n    }\n    render() {\n        return (\n            <div>\n                <Header aria-label={this.appDescription}>\n                    <SkipToContent />\n                    <HeaderName prefix=\"\">\n                        {/* <div className=\"decornone \"><NavLink exact to=\"/\"> </NavLink></div> */}\n                        <img className=\"headericon\" src=\"images/icon.png\" alt=\"\" />\n                        {this.appName}\n                    </HeaderName>\n                    <HeaderNavigation aria-label={this.appDescription}>\n                        {/* <HeaderMenuItem element={Link} to=\"/\" className=\"navbarlink \"> Datasets </HeaderMenuItem>\n                        <HeaderMenuItem element={Link} to=\"/\" className=\"navbarlink \"> Datasets </HeaderMenuItem> */}\n                        {/* <HeaderMenuItem  element={Link} to=\"/models\" className=\"navbarlink \"> Models</HeaderMenuItem> */}\n                        <div role=\"menuitem\" tabIndex={0} className=\"navbarlinks  \"><NavLink exact to=\"/\"> Introduction </NavLink></div>\n                        <div role=\"menuitem\" className=\"navbarlinks \"><NavLink to=\"/train\"> Train a Model </NavLink></div>\n                        {/* <div className=\"navbarlinks \"><NavLink to=\"/faq\"> FAQ </NavLink></div> */}\n                        {/* <div className=\"navbarlinks \"><NavLink to=\"/algebra\"> Image Algebra </NavLink></div> */}\n                        {/* <div className=\"navbarlinks \"><NavLink to=\"/energy\"> Energy Explorer </NavLink></div> */}\n                    </HeaderNavigation>\n                    <HeaderGlobalBar>\n                        {/* <HeaderGlobalAction aria-label=\"Notifications\">\n                    <Notification20 />\n                </HeaderGlobalAction>\n                */}\n                        {/* <HeaderGlobalAction aria-label=\"User Avatar\">\n                    <UserAvatar20 />\n                </HeaderGlobalAction> */}\n                        <HeaderGlobalAction aria-label=\"App Switcher\">\n                            <AppSwitcher20 />\n                        </HeaderGlobalAction>\n                    </HeaderGlobalBar>\n                </Header>\n                <div className=\"headerboost\">  </div>\n            </div>\n\n        );\n    }\n}\n\nexport default AppHeader;\n","import React, { Component } from \"react\";\nimport \"./footer.css\"\n\nclass Footer extends Component {\n    render() {\n        return (\n            <div style={{ zIndex: 999000 }}>\n                Made with <span className=\"redcolor\">&#9829;</span> by <a href=\"https://twitter.com/vykthur\" target=\"blank\">Victor Dibia</a>.\n            </div>\n        );\n    }\n}\n\nexport default Footer;","import React, { Component } from 'react'\n// import { loadJSONData, abbreviateString } from \"../helperfunctions/HelperFunctions\"\nimport \"./linechart.css\"\nimport * as d3 from \"d3\"\n\n\nclass LineChart extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            data: this.props.data,\n            predictedData: this.props.predictedData,\n            color: this.props.color\n        }\n\n\n\n        this.minChartWidth = this.props.width\n        this.minChartHeight = this.props.height\n\n        // console.log(this.props);\n\n        this.backgrounOpacity = \"63\"\n\n\n    }\n\n    componentDidMount() {\n        // console.log(\"Line component mounted\")\n        this.drawGraph()\n\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        // console.log(this.props.index, prevProps.index);\n\n        if (this.props.lastUpdated !== prevProps.lastUpdated) {\n            this.setState({ data: this.props.data })\n            // console.log(\"stuff hass changed\", this.props.data);\n            this.updateGraph(this.props.data, this.props.predictedData)\n\n        }\n\n    }\n\n    setupScalesAxes(data) {\n        this.chartMargin = { top: 10, right: 5, bottom: 40, left: 20 }\n        this.chartWidth = this.minChartWidth - this.chartMargin.left - this.chartMargin.right\n        this.chartHeight = this.minChartHeight - this.chartMargin.top - this.chartMargin.bottom;\n\n        // consolse.log(data);\n\n        var n = data.length / 2;\n\n        this.xScale = d3.scaleLinear()\n            .domain([0, n - 1]) // input\n            .range([0, this.chartWidth]); // output\n\n\n        this.yScale = d3.scaleLinear()\n            .domain([d3.min(data), d3.max(data)]) // input \n            .range([this.chartHeight, 0]); // output \n\n        this.xAxis = d3.axisBottom(this.xScale)\n        this.yAxis = d3.axisRight(this.yScale)\n            .tickSize(this.minChartWidth)\n\n    }\n\n    updateGraph(data, predictedData) {\n        let self = this\n        // console.log(data)\n        this.setupScalesAxes(data.concat(predictedData))\n        // Select the section we want to apply our changes to\n        var svg = d3.select(\"div.linechartbox\").transition();\n\n\n        let jointData = []\n        for (let i = 0; i < this.props.data.length; i++) {\n            jointData.push({ data: this.props.data[i], predictedData: this.props.predictedData[i] })\n        }\n\n        // Make the changes\n        svg.select(\".line\")   // change the line\n            .duration(750)\n            .attr(\"stroke\", this.state.color)\n            .attr(\"d\", this.line(data));\n\n        // Make the changes to predicted line\n        svg.select(\".predictedline\")   // change the line\n            .duration(750)\n            .attr(\"stroke\", this.props.predictedColor)\n            .attr(\"d\", this.line(predictedData));\n\n        svg.select(\".msearea\")\n            .duration(750)\n            .attr(\"fill\", this.props.predictedColor + this.backgrounOpacity)\n            .attr(\"stroke\", \"none\")\n            .attr(\"d\", this.msearea(jointData)\n            );\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            svg.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n        svg.select(\".y.axis\")\n            .call(customYAxis).duration(5);\n    }\n\n\n    drawGraph() {\n        let self = this\n        this.setupScalesAxes(this.state.data.concat(this.state.predictedData))\n        let width = this.chartWidth, height = this.chartHeight, margin = this.chartMargin\n\n        let jointData = []\n        for (let i = 0; i < this.props.data.length; i++) {\n            jointData.push({ data: this.props.data[i], predictedData: this.props.predictedData[i] })\n        }\n\n        // 7. d3's line generator\n        this.line = d3.line()\n            .x(function (d, i) { return self.xScale(i); }) // set the x values for the line generator\n            .y(function (d) { return self.yScale(d); }) // set the y values for the line generator \n        // .curve(d3.curveMonotoneX) // apply smoothing to the line\n\n        this.msearea = d3.area()\n            .x(function (d, i) { return self.xScale(i); })\n            .y0(function (d) { return self.yScale(Math.min(d.data, d.predictedData)) })\n            .y1(function (d) { return self.yScale(Math.max(d.data, d.predictedData)) })\n\n        // 8. An array of objects of length N. Each object has key -> value pair, the key being \"y\" and the value is a random number\n        var dataset = this.state.data\n\n        // console.log(this.state);\n\n\n        // d3.range(n).map(function (d) { return { \"y\": d3.randomUniform(1)() } })\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n\n        // 1. Add the SVG to the page and employ #2\n        var svg = d3.select(\"div.linechartbox\").append(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n\n\n        // 3. Call the x axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(customXAxis); // Create an axis component with d3.axisBottom\n\n        // 4. Call the y axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(customYAxis); // Create an axis component with d3.axisLeft\n\n        // 9. Append the path, bind the data, and call the line generator \n        svg.append(\"path\")\n            .datum(dataset) // 10. Binds data to the line \n            .attr(\"class\", \"line\") // Assign a class for styling \n            .attr(\"stroke\", this.state.color)\n            .attr(\"d\", this.line); // 11. Calls the line generator \n\n        svg.append(\"path\")\n            .datum(this.state.predictedData) // 10. Binds data to the line \n            .attr(\"class\", \"predictedline\") // Assign a class for styling \n            .attr(\"stroke\", this.props.predictedColor)\n            .attr(\"d\", this.line); // 11. Calls the line generator \n\n        svg.append(\"path\")\n            .datum(jointData)\n            .attr(\"class\", \"msearea\") // Assign a class for styling \n            .attr(\"fill\", this.props.predictedColor + this.backgrounOpacity)\n            .attr(\"stroke\", \"none\")\n            .attr(\"d\", this.msearea\n            )\n\n        // // 12. Appends a circle for each datapoint \n        // svg.selectAll(\".dot\")\n        //     .data(dataset)\n        //     .enter().append(\"circle\") // Uses the enter().append() method\n        //     .attr(\"class\", \"dot\") // Assign a class for styling\n        //     .attr(\"cx\", function (d, i) { return xScale(i) })\n        //     .attr(\"cy\", function (d) { return yScale(d) })\n        //     .attr(\"r\", 5)\n        //     .on(\"mouseover\", function (a, b, c) {\n        //         console.log(a)\n        //         // this.attr('class', 'focus')\n        //     })\n    }\n\n\n    render() {\n\n\n\n        return (\n            <div className=\"positionrelative mainchartbox \">\n                <div className=\"chartlegend legendtopleft p5 mediumdesc \">\n                    <div className=\"mb3 \">\n                        <div className=\"legendcolorbox mr5  themeblue iblock\"></div>\n                        <div ref=\"trainlabel\" className=\"iblock boldtext mr5\"> Input  </div>\n                        <div className=\"iblock \"> </div>\n                    </div>\n                    <div>\n                        <div style={{ backgroundColor: this.props.predictedColor }} className=\"legendcolorbox mr5 iblock\"></div>\n                        <div ref=\"validationlabel\" className=\"iblock boldtext mr5\"> Prediction</div>\n                        <div className=\"iblock \"></div>\n                    </div>\n                </div>\n\n                <div className=\"linechartbox \">\n\n                </div>\n\n            </div>\n        )\n    }\n}\n\nexport default LineChart","import React, { Component } from 'react'\n// import { loadJSONData, abbreviateString } from \"../helperfunctions/HelperFunctions\"\nimport \"./linechart.css\"\nimport * as d3 from \"d3\"\n\nclass SmallLineChart extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            chart: this.props.data\n        }\n\n        this.miniChartWidth = this.props.data.chartWidth\n        this.miniChartHeight = this.props.data.chartHeight\n\n\n\n\n    }\n\n    componentDidMount() {\n        // console.log(\"Line component mounted\")\n        let canvas = this.refs.smalllinecanvas\n        canvas.width = this.miniChartWidth\n        canvas.height = this.miniChartHeight;\n        this.drawGraph()\n\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n\n\n    }\n\n\n\n    drawGraph() {\n        this.chartMargin = { top: 0, right: 0, bottom: 0, left: 0 }\n        this.chartWidth = this.miniChartWidth - this.chartMargin.left - this.chartMargin.right\n        this.chartHeight = this.miniChartHeight - this.chartMargin.top - this.chartMargin.bottom;\n\n\n        let data = this.state.chart.data.data\n        var n = data.length;\n        // console.log(data, n);\n\n\n        this.xScale = d3.scaleLinear()\n            .domain([0, n - 1]) // input\n            .range([0, this.chartWidth]); // output\n\n\n        this.yScale = d3.scaleLinear()\n            .domain([d3.min(data), d3.max(data)]) // input \n            .range([0, this.chartHeight]); // output\n\n        // console.log(data);\n\n\n        let canvas = this.refs.smalllinecanvas,\n            context = canvas.getContext('2d')\n\n\n\n        context.translate(0, this.chartHeight);\n        context.scale(1, -1);\n\n        context.strokeStyle = this.state.chart.color;\n        // console.log(this.state.chart.color);\n\n\n        // context.fillStyle = '#f6f6f6';\n        // context.fillRect(0, 0, this.chartWidth, this.chartHeight);\n\n        var left = 0,\n            prev_stat = data[0],\n            move_left_by = this.chartWidth / data.length;\n\n        for (let stat in data) {\n            // console.log(data[stat], this.yScale(data[stat]));\n\n            let the_stat = this.yScale(data[stat]);\n\n            context.beginPath();\n            context.moveTo(left, prev_stat);\n            context.lineTo(left + move_left_by, the_stat);\n            context.lineWidth = 1.6;\n            context.lineCap = 'round';\n            /*\n                if(the_stat < stats[stat-1]) {\n                    context.strokeStyle = '#c0392b';\n                } else {\n                    context.strokeStyle = '#3b3b3b';\n                }\n                */\n            context.stroke();\n\n            prev_stat = the_stat;\n            left += move_left_by;\n\n        }\n    }\n\n\n    render() {\n\n\n\n        return (\n            <div className=\"iblock mt2\">\n                <canvas ref=\"smalllinecanvas\" ></canvas>\n            </div>\n        )\n    }\n}\n\nexport default SmallLineChart","import React, { Component } from \"react\";\nimport \"./drawsignal.css\"\nimport * as d3 from \"d3\"\n// import * as _ from \"lodash\"\nimport { Button } from \"carbon-components-react\"\n\nclass DrawSignal extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            signalExtracted: false\n        }\n\n\n        this.axisOffset = 20\n        this.chartWidth = this.props.width - this.axisOffset\n        // this.chartWidth = 450\n        this.chartHeight = this.props.height\n\n        // console.log(this.props, this.chartHeight, this.chartWidth);\n\n        this.smallChartWidth = 150\n        this.smallChartHeight = 40\n\n        this.prevX = 0\n        this.currX = 0\n        this.prevY = 0\n        this.currY = 0\n        this.dot_flag = false;\n\n        this.strokeColor = \"black\"\n        this.lineWidth = 2\n        this.flag = false\n\n        this.drawMap = new Map()\n        this.signalCount = 140\n        this.pointColors = []\n\n        this.scaleRange = [2, -5]\n        this.axisList = [2, 1, 0, -1, -2, -3, -4]\n\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        // console.log(\"props changing\", this.props);\n\n        // console.log(prevProps.data.epoch, this.props.data.epoch)\n        if ((this.props.width !== prevProps.width)) {\n            // console.log(\"props updated\");\n            this.chartWidth = this.props.width - this.axisOffset\n            this.setUpCanvasSize()\n        }\n\n    }\n\n    componentDidMount() {\n\n\n        this.refs.drawsignaloutcanvas.width = this.smallChartWidth\n        this.refs.drawsignaloutcanvas.height = this.smallChartHeight\n        this.smallChartContext = this.refs.drawsignaloutcanvas.getContext('2d')\n\n        // console.log(\"Line component mounted\")\n        this.largeChartCanvas = this.refs.drawsignalcanvas\n        this.setUpCanvasSize()\n        this.largeChartContext = this.largeChartCanvas.getContext('2d')\n\n        this.largeChartCanvas.addEventListener(\"mousedown\", this.mouseDownEvent.bind(this))\n        this.largeChartCanvas.addEventListener(\"mouseup\", this.mouseUpEvent.bind(this))\n        this.largeChartCanvas.addEventListener(\"mousemove\", this.mouseMoveEvent.bind(this))\n        this.largeChartCanvas.addEventListener(\"mouseout\", this.mouseOutEvent.bind(this))\n\n        this.largeChartCanvas.addEventListener(\"touchend\", this.touchEndEvent.bind(this))\n        this.largeChartCanvas.addEventListener(\"touchstart\", this.touchStartEvent.bind(this), { passive: true })\n        this.largeChartCanvas.addEventListener(\"touchmove\", this.touchMoveEvent.bind(this), { passive: true })\n\n\n        // Set up scales \n        this.xScale = d3.scaleLinear()\n            .domain([0, this.signalCount - 1]) // input\n            .range([0, this.smallChartWidth]); // output\n\n\n        this.yScale = d3.scaleLinear()\n            .domain([0, this.chartHeight]) // input \n            .range([0, this.smallChartHeight]); // output\n\n\n        this.ynScale = d3.scaleLinear()\n            .domain([0, this.chartHeight]) // input \n            .range(this.scaleRange); // output\n\n\n        this.zeroArr = new Array(this.signalCount).fill(0);\n        // this.zeroArr[0] = 2\n        // this.zeroArr[this.signalCount - 1] = -5\n\n    }\n\n    setUpCanvasSize() {\n        this.largeChartCanvas.width = this.chartWidth\n        this.largeChartCanvas.height = this.chartHeight;\n    }\n\n\n    draw() {\n\n\n        this.largeChartContext.beginPath();\n        this.largeChartContext.moveTo(this.prevX, this.prevY);\n        this.largeChartContext.lineTo(this.currX, this.currY);\n        this.largeChartContext.strokeStyle = this.strokeColor;\n        this.largeChartContext.lineWidth = this.lineWidth;\n        this.largeChartContext.stroke();\n        this.largeChartContext.closePath();\n        // console.log(this.currX, this.currY);\n\n        if (!this.drawMap.has(this.currX)) {\n            this.drawMap.set(this.currX, this.currY)\n\n        }\n\n    }\n\n\n\n    findxy(res, e) {\n        if (res === 'down') {\n            this.flag = true;\n            this.dot_flag = true;\n            if (this.dot_flag) {\n                this.largeChartContext.beginPath();\n                this.largeChartContext.fillStyle = this.strokeColor;\n                this.largeChartContext.fillRect(this.currX, this.currY, 2, 2);\n                this.largeChartContext.closePath();\n                this.dot_flag = false;\n            }\n        }\n        if (res === 'up') {\n            this.flag = false;\n            this.miniGraph()\n        }\n        if (res === \"out\") {\n            this.flag = false;\n        }\n        if (res === 'move') {\n\n        }\n    }\n\n    limitValues(x, min, max) {\n        x = x < min ? min : x\n        x = x > max ? max : x\n        return x\n    }\n\n    setXYCoords(xPos, yPos) {\n        // console.log(xPos, yPos);\n\n        xPos = this.limitValues(xPos, 0, this.chartWidth)\n        yPos = this.limitValues(yPos, 0, this.chartHeight)\n\n        this.prevX = this.currX;\n        this.prevY = this.currY;\n        this.currX = xPos\n        this.currY = yPos\n    }\n\n    updateMove(xPos, yPos) {\n        if (this.flag) {\n            this.setXYCoords(xPos, yPos)\n            this.draw();\n        }\n    }\n\n    touchStartEvent(e) {\n        console.log(e.changedTouches[0].pageY);\n        this.setXYCoords(e.changedTouches[0].pageX - this.largeChartCanvas.offsetLeft, e.changedTouches[0].pageY - this.largeChartCanvas.offsetTop)\n        this.findxy('down', e)\n    }\n\n    touchEndEvent(e) {\n        this.findxy('up', e)\n    }\n    touchMoveEvent(e) {\n        console.log(e.changedTouches.length);\n        for (let i = 0; i < e.changedTouches.length; i++) {\n            console.log(\"touchpoint[\" + i + \"].pageX = \" + e.changedTouches[i].pageX);\n            console.log(\"touchpoint[\" + i + \"].pageY = \" + e.changedTouches[i].pageY);\n            this.updateMove(e.changedTouches[i].pageX - this.largeChartCanvas.offsetLeft, e.changedTouches[i].pageY - this.largeChartCanvas.offsetTop)\n        }\n    }\n\n\n    mouseDownEvent(e) {\n        this.setXYCoords(e.pageX - this.largeChartCanvas.offsetLeft, e.pageY - this.largeChartCanvas.offsetTop)\n        this.findxy('down', e)\n    }\n    mouseUpEvent(e) {\n        this.findxy('up', e)\n    }\n    mouseMoveEvent(e) {\n        this.updateMove(e.pageX - this.largeChartCanvas.offsetLeft, e.pageY - this.largeChartCanvas.offsetTop)\n    }\n    mouseOutEvent(e) {\n        this.findxy('out', e)\n    }\n\n\n\n    componentWillUnmount() {\n        this.largeChartCanvas.removeEventListener(\"mousedown\", this.mouseDownEvent)\n        this.largeChartCanvas.removeEventListener(\"mouseup\", this.mouseUpEvent)\n        this.largeChartCanvas.removeEventListener(\"mouseover\", this.mouseMoveEvent)\n        this.largeChartCanvas.removeEventListener(\"mouseout\", this.mouseOutEvent)\n\n\n        this.largeChartCanvas.removeEventListener(\"touchend\", this.touchEndEvent)\n        this.largeChartCanvas.removeEventListener(\"touchstart\", this.touchStartEvent)\n        this.largeChartCanvas.removeEventListener(\"touchmove\", this.touchMoveEvent)\n\n\n    }\n\n    miniGraph() {\n        if (this.drawMap.size > 0) {\n            this.drawGraph(this.drawMap)\n\n        }\n    }\n\n    clearDrawing() {\n\n        this.largeChartContext.clearRect(0, 0, this.chartWidth, this.chartHeight);\n        this.smallChartContext.clearRect(0, 0, this.smallChartWidth, this.smallChartHeight);\n\n        this.drawMap = new Map()\n        this.setState({ signalExtracted: false })\n\n        this.props.updateCurrentSignal(this.zeroArr)\n    }\n\n    rangeMean(i, start, end, prevMean, data) {\n        let sum = 0\n        let count = 0\n        for (let i = start; i <= end; i++) {\n            if (data.get(i * 1)) {\n                sum += data.get(i * 1)\n                count++\n            }\n        }\n\n        let rangeMean = sum / count\n        this.pointColors[i] = \"blue\"\n        if (count === 0) {\n            rangeMean = prevMean\n            this.pointColors[i] = \"orange\"\n        }\n\n        // console.log(start, end, sum, count, rangeMean);\n        return rangeMean\n    }\n    drawGraph(data) {\n\n        let canv = this.refs.drawsignaloutcanvas\n        let context = canv.getContext(\"2d\")\n\n        this.smallChartContext.clearRect(0, 0, this.chartWidth, this.chartWidth);\n\n        // context.translate(0, this.chartHeight);\n        // context.scale(1, -1);\n\n        let prevMean = data.values().next().value\n        let curMean = 0\n        let signalHolder = []\n        let signalHolderScaled = []\n\n        let step = (this.chartWidth / this.signalCount)\n        for (let i = 0; i < this.signalCount; i++) {\n            curMean = this.rangeMean(i, Math.floor(i * step), Math.floor(i * step + step), prevMean, data)\n            signalHolder[i] = curMean\n            signalHolderScaled[i] = this.ynScale(curMean)\n            prevMean = curMean\n        }\n        this.setState({ signalExtracted: true })\n        this.props.updateCurrentSignal(signalHolderScaled)\n\n\n        // console.log(signalHolder);\n        let prevX = 0, prevY = signalHolder[0]\n        let currX = 0, currY = 0\n        for (let i = 1; i < signalHolder.length; i++) {\n            currX = i\n            currY = signalHolder[i] || signalHolder[i - 1]\n            context.beginPath();\n            context.moveTo(this.xScale(prevX), this.yScale(prevY));\n            context.lineTo(this.xScale(currX), this.yScale(currY));\n            context.strokeStyle = this.pointColors[i]\n            context.lineWidth = this.lineWidth;\n            context.stroke();\n            context.closePath();\n            prevX = currX\n            prevY = currY\n\n        }\n    }\n\n    drawSample() {\n\n    }\n\n\n    render() {\n        let xaxis = this.axisList.map((data) => {\n            return (\n                <div style={{ height: this.chartHeight / this.axisList.length }} key={\"axisbox\" + data} className=\"axiscell \">\n                    <div className=\"axiscelltext mediumdesc\">   {data}</div>\n                </div>\n            )\n        })\n        return (\n            // <div style={{ width: this.chartWidth + 25 }} className=\"mt2 border p10\">\n            <div className=\" w100 \" >\n                <div className=\"pb10  mediumdesc\">\n                    Click and drag to draw a signal. Please draw within the box.\n                        </div>\n                <div>\n                    <div className=\" w100 flex\">\n                        <div className=\" axisbox mr5 iblock\">\n                            {xaxis}\n                        </div>\n                        <div className=\"flexfull  iblock\">\n\n                            <div className={\"unclickable positionabsolute  smallchartbox \" + (this.state.signalExtracted ? \" \" : \" displaynone\")} >\n                                <canvas className=\"smallchart\" ref=\"drawsignaloutcanvas\" id=\"smallsignalcanvas\"></canvas>\n                                <div className={\"smalldesc extractedsignal \" + (this.state.signalExtracted ? \" \" : \" displaynone\")}> Extracted signal </div>\n                                {/* <div className={\"smalldesc pt5 \" + (this.state.signalExtracted ? \" \" : \" displaynone\")}> draw signal </div> */}\n                            </div>\n                            <div style={{ height: this.chartHeight }} className=\"\">\n\n                                <canvas className=\"border iblock largechart\" ref=\"drawsignalcanvas\" id=\"drawsignalcanvas\"></canvas>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div className=\"pt10\">\n\n                        <div className=\"iblock mr5\">\n                            <Button\n                                size={\"field\"}\n                                renderIcon={null}\n                                onClick={this.clearDrawing.bind(this)}\n                            > Clear Drawing </Button>\n                        </div >\n                        <div className=\"iblock\">\n                            <Button\n                                size={\"field\"}\n                                renderIcon={null}\n                                onClick={this.drawSample.bind(this)}\n                            > Draw Sample </Button>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default DrawSignal","import React, { Component } from 'react'\nimport { Loading } from 'carbon-components-react';\n// import { loadJSONData } from \"../helperfunctions/HelperFunctions\"\nimport \"./viz.css\"\nimport LineChart from \"../linechart/LineChart\"\nimport SmallLineChart from \"../linechart/SmallLineChart\"\nimport DrawSignal from \"../drawsignal/DrawSignal\"\n// import \"../../data\" \nimport * as tf from '@tensorflow/tfjs';\n\nclass Viz extends Component {\n    constructor(props) {\n        super(props)\n\n        this.modelChartWidth = Math.min(390, window.innerWidth - 25)\n        this.modelChartHeight = 280\n\n        // Allow the draw signal component update current signal with drawn signal\n        this.updateCurrentSignal = this.updateCurrentSignal.bind(this)\n\n\n\n        this.testData = require(\"../../data/ecg/test.json\")\n        this.testData = this.testData.slice(0, 70)\n\n        this.zeroArr = new Array(this.testData[0].data.length).fill(0);\n\n\n        this.state = {\n            apptitle: \"Anomagram\",\n            trainData: [],\n            selectedIndex: 0,\n            selectedData: this.testData[0].data,\n            showDrawData: false,\n            drawSectionWidth: 350,\n            drawSectionHeight: this.modelChartHeight - 30,\n            isLoading: false,\n            modelLoaded: false,\n            threshold: 0.011,\n            predictedData: this.zeroArr,\n            predictedMse: null,\n            selectedLegend: \"All\",\n        }\n\n\n        // this.trainData = require(\"../../data/ecg/train.json\")\n        // console.log(this.testData.length, this.trainData.length)\n\n        this.loadData()\n\n        this.chartColorMap = {\n            0: { color: \"grey\", colornorm: \"grey\", name: \"All\" },\n            1: { color: \"#0062ff\", colornorm: \"#0062ff\", name: \"Normal\" },\n            2: { color: \"#ffa32c\", colornorm: \"grey\", name: \"R-on-T Premature Ventricular Contraction\" },\n            // 3: { color: \"violet\", colornorm: \"grey\", name: \"Supraventricular Premature or Ectopic Beat\" },\n            4: { color: \"orange\", colornorm: \"grey\", name: \"Premature Ventricular Contraction\" },\n            5: { color: \"red\", colornorm: \"grey\", name: \"Unclassifiable Beat\" },\n        }\n\n        this.maxSmallChart = 100\n        this.modelDataLastUpdated = true\n\n\n\n    }\n\n\n    loadData() {\n        // let testECGDataPath = process.env.PUBLIC_URL + \"/data/ecg/test_small.json\"\n        // let trainECGDataPath = process.env.PUBLIC_URL + \"/data/ecg/train_small.json\"\n        // loadJSONData(testECGDataPath).then(data => {\n        //     this.setState({ testData: data })\n        //     // console.log(\"test data loaded\", data.length)\n        // })\n\n        // loadJSONData(trainECGDataPath).then(data => {\n        //     this.setState({ trainData: data })\n        // })\n\n    }\n    componentDidUpdate(prevProps, prevState) {\n\n\n    }\n\n\n    componentDidMount() {\n        this.apptitle = \"Amadioha\"\n\n        // window.addEventListener(\"resize\", this.onWindowResize.bind(this))\n        // console.log(this.refs[\"datasection\"].offsetWidth)\n        this.setState({ drawSectionWidth: this.refs[\"datasection\"].offsetWidth - 5 })\n        this.drawSectionWidth = this.refs[\"datasection\"].offsetWidth\n\n        // console.log(tf.memory());\n\n        this.xMinArray = require(\"../../data/ecg/transform/xmin.json\")\n        this.xMaxArray = require(\"../../data/ecg/transform/xmax.json\")\n\n        this.featureRange = require(\"../../data/ecg/transform/range.json\")\n    }\n\n    componentWillUnmount() {\n        // window.removeEventListener(\"resize\", this.onWindowResize)\n        if (this.loadedModel) {\n            this.loadedModel.dispose()\n        }\n    }\n\n    applyTransform(data) {\n        let holder = []\n        for (let i = 0; i < data.length; i++) {\n            holder[i] = ((data[i] - this.xMinArray[i]) / (this.xMaxArray[i] - this.xMinArray[i])) * (this.featureRange[\"max\"] - this.featureRange[\"min\"]) + this.featureRange[\"min\"]\n        }\n        return holder\n    }\n\n    applyReverseTransform(data) {\n        let holder = []\n        // df = ((df - xmin) / (xmax - xmin)) * (max_val - min_val) + min_val\n        // real_output = data * (b - a) + a\n        for (let i = 0; i < data.length; i++) {\n            holder[i] = ((data[i] - this.featureRange[\"min\"]) / (this.featureRange[\"max\"] - this.featureRange[\"min\"])) * (this.xMaxArray[i] - this.xMinArray[i]) + this.xMinArray[i]\n        }\n        return holder\n    }\n\n\n\n\n    loadModel() {\n        this.setState({ isLoading: true })\n        setTimeout(() => {\n            let modelPath = \"/webmodel/ecg/model.json\"\n            tf.loadLayersModel(modelPath).then((model) => {\n                this.loadedModel = model\n                this.setState({ modelLoaded: true, isLoading: false })\n                this.getPrediction(this.state.selectedData)\n            });\n        }, 700);\n    }\n\n    // Get predictions for a selected datapoint\n    getPrediction(data) {\n\n        if (!this.state.modelLoaded) {\n            this.setState({ selectedData: data })\n            this.loadModel()\n        } else {\n            this.setState({ isLoading: true })\n\n            let transformedData = this.applyTransform(data)\n            // let revTrans = this.applyReverseTransform(transformedData)\n            // console.log(data.slice(0, 5), revTrans.slice(0, 5));\n\n\n            // Get predictions  \n            const [mse, preds] = tf.tidy(() => {\n                let dataTensor = tf.tensor2d(transformedData, [1, 140])\n                let preds = this.loadedModel.predict(dataTensor, { batchSize: 8 })\n                return [tf.sub(preds, dataTensor).square().mean(1), preds]\n            })\n\n            mse.array().then(array => {\n                // console.log(array);\n                this.setState({ isLoading: false, predictedMse: array[0] })\n            });\n\n            preds.array().then(array => {\n                this.modelDataLastUpdated = !this.modelDataLastUpdated\n                this.setState({ selectedData: data, predictedData: this.applyReverseTransform(array[0]) }, () => {\n\n                })\n            });\n\n            mse.dispose()\n            preds.dispose()\n        }\n\n\n\n    }\n\n\n\n    updateCurrentSignal(data) {\n        this.getPrediction(data)\n    }\n\n\n    clickDataPoint(e) {\n\n        let selectedData = this.testData[e.target.getAttribute(\"indexvalue\")].data\n        // set data and get predictions on click \n        this.setSelectedData(e.target.getAttribute(\"indexvalue\"), selectedData)\n\n    }\n\n    setSelectedData(index, data) {\n\n        this.setState({ selectedIndex: index }, () => {\n            this.getPrediction(data)\n        })\n    }\n\n    onWindowResize() {\n        console.log(this.refs[\"datasection\"].offsetWidth);\n\n        this.setState({ drawSectionWidth: this.refs[\"datasection\"].offsetWidth - 5 })\n    }\n\n\n    toggleDataOptions(e) {\n        this.setState({ showDrawData: e })\n\n    }\n    setDatasetDraw(e) {\n        this.setState({ showDrawData: true })\n        // this.setState({ drawSectionWidth: this.refs[\"datasection\"].offsetWidth })\n        // console.log(this.refs[\"datasection\"].offsetWidth);\n\n    }\n    setDatasetECG(e) {\n        this.setState({ showDrawData: false })\n\n        this.setSelectedData(0, this.testData[0].data)\n\n    }\n\n    clickLegend(e) {\n        // console.log(e.target);\n        // this.state.selectedLegend = e.target.getAttribute(\"action\")\n        this.setState({ selectedLegend: e.target.getAttribute(\"action\") })\n    }\n\n    render() {\n\n\n        let dataLegend = Object.entries(this.chartColorMap).map((data, index) => {\n            let color = data[1].color\n            let name = data[1].name\n            // console.log(name); \n            return (\n                <div action={name} onClick={this.clickLegend.bind(this)} className={\"iblock mr5 mb5 legendrow clickable\" + (this.state.selectedLegend === name ? \" active\" : \" \")} key={\"legendrow\" + index}>\n                    <div style={{ background: color }} className=\"unclickable indicatorcircle iblock mr5\"></div>\n                    <div className=\"iblock unclickable legendtext pl4 mediumdesc\"> {name}</div>\n\n\n                </div>\n            )\n        });\n\n        let dataPoints = this.testData.slice(0, this.maxSmallChart).map((data, index) => {\n            // console.log(this.testData[index].target);\n            if (this.testData[index].target + \"\" !== \"3\") {\n                let isVisible = (this.state.selectedLegend === this.chartColorMap[this.testData[index].target].name) || this.state.selectedLegend === \"All\"\n\n                console.log();\n\n                return (\n                    <div onClick={this.clickDataPoint.bind(this)} key={\"testrow\" + index} className={\"mb5 p5 clickable  ecgdatapoint rad3 iblock mr5\" + (isVisible ? \" \" : \" displaynone \") + (this.state.selectedIndex + \"\" === index + \"\" ? \" active \" : \"\")} indexvalue={index} targetval={data.target} >\n                        <div indexvalue={index} className=\"boldtext  unclickable iblock \">\n                            <div className=\"positionrelative\">\n                                <div className=\"p3 indicatoroutrcircle  positionabsolute bottomright\">\n                                    <div style={{ background: this.chartColorMap[this.testData[index].target].color }} className=\"indicatorcircle \"></div>\n                                </div>\n                                <SmallLineChart\n                                    data={{\n                                        data: this.testData[index],\n                                        index: index,\n                                        color: this.chartColorMap[this.testData[index].target].colornorm,\n                                        chartWidth: 72,\n                                        chartHeight: 30\n                                    }}\n                                > </SmallLineChart>\n                            </div>\n\n                        </div>\n\n                    </div>\n                )\n            }\n        });\n\n        let datasetExamples = (\n            <div className=\"flex\">\n                <div className=\"flex20 mr10\">\n                    <div className=\"mb5\">\n                        {dataLegend}\n                    </div>\n                    <div className=\"ecgdatabox scrollwindow\">\n                        {dataPoints}\n                    </div>\n                </div>\n                <div className=\"p10 greyhighlight displaynone\">\n                    Threshold ring implementation\n                </div>\n            </div>\n        )\n\n        let dataSketchPad = (\n            <div >\n                <DrawSignal\n                    width={this.state.drawSectionWidth}\n                    height={this.state.drawSectionHeight}\n                    updateCurrentSignal={this.updateCurrentSignal}\n                ></DrawSignal>\n            </div>\n        )\n        let barColor = this.state.predictedMse ? this.state.predictedMse > this.state.threshold ? \"#ff0000\" : \"#008000\" : \"#808080\"\n        let modelOutput = (\n            <div className=\"  modeloutputbox rad5 \">\n                {/* <div className=\"mb10 boldtext\"> Model Prediction</div> */}\n                <div className=\"flex  \">\n                    <div className=\"iblock \">\n                        <div ref=\"\" className=\"resetbox vizloadingbox\" style={{ opacity: (this.state.isLoading) ? 1 : 0, width: (this.state.isLoading) ? \"34px\" : \"0px\" }} >\n                            <Loading\n                                className=\" mr10\"\n                                active={true}\n                                small={true}\n                                withOverlay={false}\n                            > </Loading>\n                        </div>\n                    </div>\n                    <div className=\"flexfull \">\n                        {this.testData.length > 0 &&\n                            <div className=\"mt5 mediumdesc mb5\">\n                                {this.state.predictedMse &&\n                                    <div className=\"mr10 boldtext \">\n                                        MODEL PREDICTION [<span className=\"\"> MSE = </span>  {this.state.predictedMse.toFixed(3)}]:\n                                  {/* {this.testData[this.state.selectedIndex].target + \"\" === \"1\" ? \"NORMAL\" : \"ABNORMAL\"} */}\n                                        &nbsp;\n                                {this.state.predictedMse > this.state.threshold ? \"ABNORMAL\" : \"NORMAL\"}\n                                    </div>\n                                }\n                                {!this.state.predictedMse &&\n                                    <div className=\"mr10 boldtext \">\n                                        MODEL PREDICTION : Select a signal or draw one!\n                            </div>}\n                                <div style={{ backgroundColor: barColor }} ref=\"predictioncolordiv\" className=\"mt5 colorbox redbox\"></div>\n\n\n                            </div>\n                        }\n                    </div>\n                </div>\n                <div className=\"iblock \">\n                    <LineChart\n                        data={this.state.selectedData}\n                        predictedData={this.state.predictedData}\n                        predictedColor={barColor}\n                        index={this.state.selectedIndex}\n                        lastUpdated={this.modelDataLastUpdated}\n                        color={this.chartColorMap[this.testData[this.state.selectedIndex].target].colornorm}\n                        width={this.modelChartWidth}\n                        height={this.modelChartHeight}\n                    > </LineChart>\n                </div>\n            </div>\n        )\n\n        // if (this.refs[\"datasetexamplebox\"]) {\n        //     console.log(this.refs[\"datasetexamplebox\"].offsetWidth);\n        // } \n\n        return (\n            <div>\n                <div className=\"bold mt10 sectiontitle mb10\">\n                    A Gentle Introduction to Anomaly Detection with Deep Learning (in the Browser!)\n                </div>\n\n                <div className=\"mynotif h100 lh10  lightbluehightlight maxh16  mb10\">\n                    {this.state.apptitle} is an interactive visualization tool for exploring\n                    deep learning models applied to the task of anomaly detection (on stationary data).\n                </div>\n\n\n                <div className=\"mediumdesc pb5 \"> Select  Data source</div>\n\n                <div className=\"mb10 lowerbar\">\n                    <div onClick={this.setDatasetECG.bind(this)} className={\"datasettab clickable iblock mr5 \" + (this.state.showDrawData ? \"\" : \" active\")}> ECG5000 Dataset</div>\n                    <div onClick={this.setDatasetDraw.bind(this)} className={\"datasettab clickable iblock mr10 \" + (this.state.showDrawData ? \" active\" : \" \")}> Draw your ECG data</div>\n\n\n                </div>\n\n                <div className=\"flex flexwrap \">\n\n                    <div ref=\"datasection\" className=\" flexwrapitem  flex20 mr10 \" >\n                        {<div ref=\"datasetexamplebox\" className={\" \" + (this.state.showDrawData ? \" displaynone\" : \" \")}>\n                            {datasetExamples}\n                        </div>}\n                        {<div className={\" \" + (!this.state.showDrawData ? \" displaynone\" : \" \")}>\n                            {dataSketchPad}\n                        </div>}\n                    </div>\n\n                    {/* <div style={{width: \"200px\"}} className=\"flexwrapitem h100 p10 border\">\n                             Threshold gauge etc\n                     </div>\n                    */}\n                    <div className=\"flexwrapitem\">\n                        {modelOutput}\n                    </div>\n                </div>\n                <div className=\"lh10 \">\n                    We have trained a two layer autoencoder with 2600 samples of normal ECG signal data.\n                    Each ECG signal contains 140 recordings of the electrical signal of the heart, corresponding to a heartbeat.\n                    Our test set (above) contains both normal and abormal ECG signals, and our model is tasked with distinguishing normal from abnormal signal.\n\n                </div>\n\n\n                {\n                    <div className=\" \">\n                        <div className=\"sectiontitle mt10 mb5\"> An Introduction to Autoencoders </div>\n                        <div className=\"\">\n                            <div className=\"flex\">\n                                <div className=\"flex6 lh10 mb10 pr10\">\n                                    An autoencoder is a neural network that learns to map input data to a low dimension representation\n                                        and then reconstruct the original input from this low dimension representation. The part of the network which learn the input to\n                                        low dimension mapping is termed an encoder, while the section that maps from low dimension back to original input is termed the decoder.\n                                    This capability of producing a low dimension representation is reminiscent dimensionality reduction approaches (e.g. PCA), and indeed\n                                    Autoencoders have been typically used for dimensionbality reduction and compression use cases. For an indepth treatment of autoencoders, please see ...\n\n                                    However, while\n                            </div>\n\n                                <div className=\"border rad4 p10 flex4\" style={{ height: \"200px\" }}>\n                                    small autoencoder viz\n                            </div>\n                            </div>\n\n                        </div>\n\n\n                        <div className=\"sectiontitle mt10 mb5\"> Modeling Normal Data  </div>\n                        <div className=\"\">\n                            <div className=\"flex lh10 flexwrap\">\n                                <div className=\"flex20 flexwrapitem  mb10 pr10\">\n                                    <div className=\"pb5 boldtext\"> Data Transformation  </div>\n                                    The range of output values from the autoencoder is dependent on the type of activation function used in the final dense layer.\n                                    For example, the tanh activation function outputs values in the range of -1 and 1. The autoencoder is tasked with reconstructing the input data.\n                                    To achieve this, it makes sense to transform the input data such that it falls in the range which our network can output.\n                                    To this end,  we apply a min-max scaling functiion in which the original data (which  is in the 2 to -5 range) is\n                                    first transformed to the 0 -1 range. Our output activation function is also set to sigmoid which outputs values in the same 0-1 range.\n                                    The network is trained on this scaled data, and at test time we apply the same transformation to new test data and the reverse transform\n                                    to the predicted result before it is visualized. Note that the transformation parameters are\n                                    <a href=\" https://sebastianraschka.com/faq/docs/scale-training-test.html\" target=\"_blank\" rel=\"noopener noreferrer\"> computed only on train data</a>\n                                    , before being applied at\n                                   test time.\n\n                            </div>\n                                <div className=\" flex20 flexwrapitem mr10\">\n                                    <div className=\"pb5 boldtext\"> Model Training </div>\n                                    Most approaches to anomaly detection (and there are many) begin by constructing a model of\n                                        normal behaviour and then exploit this model to identify deviations from normal (anomalies or abnormal data).\n                                    Here is how we can use an autoencoder to model normal behaviour. If you recall, an autoencoder learns to compress\n                                    and reconstruct data. Notably this learned mapping is specific to the data type/distribution distribution of the training data.\n                                    In other words an autoencoder trained using 15 px images of dogs is unlikely to correctly reconstruct 20px images of the surface\n                                    of the moon.\n                            </div>\n\n\n                                <div className=\"border rad4 p10 \" style={{ width: \"300px\", height: \"300px\" }}>\n                                    Interactive replay of training run visualization\n                            </div>\n                            </div>\n\n                        </div>\n\n                        <div className=\"sectiontitle mt10 mb5\"> Model Evaluation: Accuracy is NOT Enough </div>\n                        <div className=\"\">\n                            <div className=\"flex\">\n                                <div className=\"flex6 lh10 mb10 pr10\">\n                                    Data for this problem is likely imbalanced. The number of anomalies we encounter is likely to be much smaller than normal data.\n                                    Consider we have a bad classifiier that simply flags all our data points as normal, it would still have a high accuracy value.\n\n                            </div>\n\n                                <div className=\"border rad4 p10 flex4\" style={{ height: \"200px\" }}>\n                                    ROC curve and some metrics\n                            </div>\n                            </div>\n\n                        </div>\n\n                        <div className=\"sectiontitle mt10 mb10\"> Effect of Model Parameters </div>\n                        <div className=\"flex flexwrap\">\n\n                            <div className=\"flex3 flexwrapitem mr10\">\n                                <div className=\"flex6 lh10 mb10 pr10\">\n                                    <div className=\"pb5 boldtext\"> Learning Rate </div>\n                                    Data for this problem is likely imbalanced. The number of anomalies we encounter is likely to be much smaller than normal data.\n                                    Consider we have a bad classifiier that simply flags all our data points as normal, it would still have a high accuracy value.\n\n                                </div>\n\n\n                            </div>\n\n                            <div className=\"flex3 flexwrapitem  mr10\">\n                                <div className=\"flex6 lh10 mb10 pr10\">\n                                    <div className=\"pb5 boldtext\"> Regularization </div>\n                                    Data for this problem is likely imbalanced. The number of anomalies we encounter is likely to be much smaller than normal data.\n                                    Consider we have a bad classifiier that simply flags all our data points as normal, it would still have a high accuracy value.\n\n                                </div>\n\n\n                            </div>\n\n                            <div className=\"flex4 flexwrapitem  mr10\">\n                                <div className=\"flex6 lh10 mb10 pr10\">\n                                    <div className=\"pb5 boldtext\"> Batch Size </div>\n                                    Data for this problem is likely imbalanced. The number of anomalies we encounter is likely to be much smaller than normal data.\n                                    Consider we have a bad classifiier that simply flags all our data points as normal, it would still have a high accuracy value.\n\n                                </div>\n                            </div>\n\n                            <div className=\"flex4 flexwrapitem  mr10\">\n                                <div className=\"flex6 lh10 mb10 pr10\">\n                                    <div className=\"pb5 boldtext\"> Abnormal Percentage </div>\n                                    Data for this problem is likely imbalanced. The number of anomalies we encounter is likely to be much smaller than normal data.\n                                    Consider we have a bad classifiier that simply flags all our data points as normal, it would still have a high accuracy value.\n\n                                </div>\n                            </div>\n                        </div>\n\n\n                        <div className=\"sectiontitle mt10 mb5\"> Lottery Tickets: Winning Initializations </div>\n                        <div className=\"\">\n                            <div className=\"flex\">\n                                <div className=\"flex6 lh10 mb10 pr10\">\n                                    Ever heard of a weird thing with neural networks called a lottery ticket?\n                                        While the problem in this example is relatively too simple (140 features, not so complex patters)\n                                    An observation of what happens each time the autoencoder is initialized can provide insights into the\n                                    how luck some nerual network initializations can be.\n                                    In essence, there are initializationsss that immeidately result in a high performance (good AUC) mpodel\n                                    and require very littl\n                                    while others are just plain bad.\n                            </div>\n\n                                <div className=\"border rad4 p10 flex4\" style={{ height: \"200px\" }}>\n                                    ROC curve and some metrics\n                            </div>\n                            </div>\n\n                        </div>\n                    </div>\n                }\n\n\n\n\n\n\n                <div>\n                    {/* A VAE (an extension of an AE) can allow us generate sampled data without */}\n                </div>\n\n\n\n\n\n                <br />\n                <br />\n                <br />\n                <br />\n            </div>\n        )\n    }\n}\n\nexport default Viz","// import { ToastNotification } from \"carbon-components-react\"\n\nexport function showToast(type, message, duration = 4000) {\n    let notifbox = document.getElementById(\"notificatiionbox\")\n    let notif = document.createElement('div');\n    notif.className = \"notificationinner\"\n    notif.innerHTML = \"\" + message\n    notifbox.append(notif)\n    notif.style.opacity = 1\n    // console.log(notifbox);\n\n    setTimeout(() => {\n        // notif.remove()\n        notif.style.opacity = 0\n        setTimeout(() => {\n            notif.remove()\n        }, 1500);\n    }, duration);\n\n}\n\nexport function computeAccuracyGivenThreshold(data, threshold) {\n\n    let predVal = 0\n    let truePositive = 0\n    let trueNegative = 0\n    let falsePositive = 0\n    let falseNegative = 0\n\n    data.forEach(each => {\n        predVal = each.mse > threshold ? 1 : 0\n        if ((each.label === 1) && (predVal === 1)) {\n            truePositive++\n        }\n        if ((each.label === 0) && (predVal === 0)) {\n            trueNegative++\n        }\n\n        if ((each.label === 0) && (predVal === 1)) {\n            falsePositive++\n        }\n\n        if ((each.label === 1) && (predVal === 0)) {\n            falseNegative++\n        }\n    });\n\n    let metricRow = {\n        acc: (truePositive + trueNegative) / data.length,\n        threshold: threshold,\n        tp: truePositive,\n        tn: trueNegative,\n        fp: falsePositive,\n        fn: falseNegative,\n        tpr: truePositive / (truePositive + falseNegative),\n        fpr: falsePositive / (trueNegative + falsePositive),\n        fnr: falseNegative / (truePositive + falseNegative),\n        tnr: trueNegative / (trueNegative + falsePositive),\n\n    }\n\n    return metricRow\n\n}\n\nexport function percentToRGB(percent) {\n    percent = 100 - percent\n    if (percent === 100) {\n        percent = 99\n    }\n    let r, g, b;\n\n    if (percent < 50) {\n        // green to yellow\n        r = Math.floor(255 * (percent / 50));\n        g = 255;\n\n    } else {\n        // yellow to red\n        r = 255;\n        g = Math.floor(255 * ((50 - percent % 50) / 50));\n    }\n    b = 0;\n\n    return \"rgb(\" + r + \",\" + g + \",\" + b + \")\";\n}\n\n\nexport function abbreviateString(value, maxLength) {\n    if (value.length <= maxLength) {\n        return value\n    } else {\n        let retval = value.substring(0, maxLength) + \" ..\"\n        return retval\n    }\n}\n\nexport function boundWidth(widthVal) {\n    if (widthVal < 0) {\n        return 0;\n    } else if (widthVal > 1) {\n        return 1;\n    } else {\n        return widthVal;\n    }\n}\n\nfunction intlFormat(num) {\n    return new Intl.NumberFormat().format(Math.round(num * 10) / 10);\n}\nexport function makeFriendly(num) {\n    if (num < 1 && num > 0) {\n        return num\n    }\n    if (Math.abs(num) >= 1000000)\n        return intlFormat(num / 1000000) + 'M';\n    if (Math.abs(num) >= 1000)\n        return intlFormat(num / 1000) + 'k';\n    return intlFormat(num);\n}\n\nexport function loadJSONData(url) {\n    return fetch(url)\n        .then(\n            function (response) {\n                if (response.status !== 200) {\n                    console.log('Looks like there was a problem. Status Code: ' + response.status);\n                    return;\n                }\n                // Examine the text in the response\n                //    response.text().then(function(data){\n                //        console.log(data)\n                //    })\n                return response.json().then(function (data) {\n                    return data\n                });\n            }\n        )\n        .catch(function (err) {\n            console.log('Fetch Error :-S', err);\n        });\n}\n\nexport function ColorArray() {\n    let colorArray = [\n        \"#1f78b4\",\n        \"#b2df8a\",\n        \"#33a02c\",\n        \"#fb9a99\",\n        \"#e31a1c\",\n        \"#fdbf6f\",\n        \"#ff7f00\",\n        \"#6a3d9a\",\n        \"#cab2d6\",\n        \"#ffff99\",\n        \"#8fff4f\"\n    ]\n    return colorArray\n}\n\n\nexport function ColorArrayRGB() {\n    let colorArray = [\n        [141, 211, 199],\n        [255, 255, 179],\n        [190, 186, 218],\n        [251, 128, 114],\n        [128, 177, 211],\n        [253, 180, 98],\n        [179, 222, 105],\n        [252, 205, 229],\n        [188, 128, 189],\n        [204, 235, 197],\n    ]\n    return colorArray\n}\n\nexport function checkInView(container, element, partial, containerOffset, elementOffset) {\n\n    if (container) {\n        //Get container properties\n        let cTop = container.scrollTop;\n        let cBottom = cTop + container.clientHeight + containerOffset;\n\n        //Get element properties\n        let eTop = element.offsetTop + elementOffset;\n        let eBottom = eTop + element.clientHeight;\n\n        //Check if in view    \n        let isTotal = (eTop >= cTop && eBottom <= cBottom);\n        let isPartial = partial && (\n            (eTop < cTop && eBottom > cTop) ||\n            (eBottom > cBottom && eTop < cBottom)\n        );\n\n        //Return outcome\n        // console.log(\"cT:\", cTop, \"conHei\", container.clientHeight, \" offset\", containerOffset, elementOffset, container.offsetTop)\n        // console.log(element.offsetTop, \"eT:\", eTop, \"cT:\", cTop, \"eB:\", eBottom, \"cB:\", cBottom, isTotal || isPartial)\n        return (isTotal || isPartial);\n    } else {\n        return false\n    }\n\n\n}\n\nexport const LeaderLine = window.LeaderLine;\nexport const animOptions = { duration: 800, timing: 'ease' }\nexport const greyColor = \"rgba(189, 195, 199, 0.5)\"\nexport const blueColor = 'rgba(0,98,255, 1)'\n","import React, { Component } from \"react\";\nimport \"./rocchart.css\"\nimport * as d3 from \"d3\"\n\n\nclass ROCChart extends Component {\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            chart: this.props.data\n        }\n        this.minChartWidth = this.props.data.chartWidth\n        this.minChartHeight = this.props.data.chartHeight\n\n        this.numTicks = 40\n        this.dotRadius = 1\n    }\n\n    componentDidMount() {\n        this.drawGraph(this.props.data.data)\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n\n\n        // if ((prevProps.data.isTraining !== this.props.data.isTraining)) {\n        //     console.log(\"props updated\");\n        //     this.updateGraph(this.props.data.data)\n        // }\n\n        if ((prevProps.data.epoch !== this.props.data.epoch) || this.props.data.epoch + \"\" === \"0\") {\n            this.updateGraph(this.props.data.data)\n        }\n    }\n\n    updateGraph(data) {\n        let self = this\n\n        d3.select(\"div.ROCChart\").selectAll(\".rocnode > *\").remove();\n\n        this.setupScalesAxes(data)\n        let svg = d3.select(\"div.ROCChart\").transition();\n\n        svg.select(\".rocline\")\n            .duration(self.animationDuration)\n            .attr(\"d\", this.rocLine(data)); // 11. Calls the line generator \n\n        svg.select(\".rocarea\")\n            .duration(self.animationDuration)\n            .attr(\"d\", this.rocArea(data)); // 11. Calls the line generator \n\n        d3.select(\"div.ROCChart\")\n            .select(\".rocnode\")\n            .selectAll(\"rocdot\")\n            .data(data)\n            .join(\"circle\")\n            .attr(\"cx\", function (d) { return self.xScale(d.fpr); })\n            .attr(\"cy\", function (d) { return self.yScale(d.tpr); })\n            .attr(\"r\", this.dotRadius)\n            .attr(\"class\", \"rocdot\")\n\n\n\n\n        // svg.select(\".lossvalcolor\")\n        //     .duration(self.animationDuration)\n        //     .attr(\"d\", this.valLine); // 11. Calls the line generator  \n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -30).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n\n        svg.select(\".y.axis\")\n            .call(customYAxis);\n\n        svg.select(\".x.axis\")\n            .call(customXAxis);\n\n    }\n    setupScalesAxes(data) {\n        // console.log(data);\n\n        // let self = this \n        this.chartMargin = { top: 10, right: 10, bottom: 55, left: 55 }\n        this.chartWidth = this.minChartWidth - this.chartMargin.left - this.chartMargin.right\n        this.chartHeight = this.minChartHeight - this.chartMargin.top - this.chartMargin.bottom;\n\n\n        // this.xScale = d3.scaleLinear()\n        //     .domain([d3.min(data, function (d) { return d.fpr }),\n        //     d3.max(data, function (d) { return d.fpr })]) // input \n        //     .range([0, this.chartWidth]); // output\n        this.xScale = d3.scaleLinear()\n            .domain([0, 1]) // input \n            .range([0, this.chartWidth]); // output\n\n\n        // this.yScale = d3.scaleLinear()\n        //     .domain([d3.min(data, function (d) { return d.tpr }),\n        //     d3.max(data, function (d) { return d.tpr })]) // input \n        //     .range([this.chartHeight, 0])\n        this.yScale = d3.scaleLinear()\n            .domain([0, 1]) // input \n            .range([this.chartHeight, 0])\n\n        this.xAxis = d3.axisBottom(this.xScale)\n        this.yAxis = d3.axisRight(this.yScale)\n            .tickSize(this.minChartWidth)\n    }\n    drawLines(svg, data) {\n        let self = this\n\n        svg.append(\"path\")\n            .datum(data) // 10. Binds data to the line \n            .attr(\"class\", \"rocline roccolor\") // Assign a class for styling  \n            .attr(\"d\", this.rocLine); // 11. Calls the line generator \n\n\n        svg.append(\"path\")\n            .datum(data)\n            .attr(\"class\", \"rocarea\")\n            .attr(\"d\", this.rocArea);\n\n        svg.append(\"line\")\n            .attr(\"x1\", this.xScale(0))  //<<== change your code here\n            .attr(\"y1\", this.yScale(0))\n            .attr(\"x2\", this.chartWidth)  //<<== and here\n            .attr(\"y2\", this.yScale(this.yScale.domain()[1]))\n            .attr(\"class\", \"diagonal\")\n\n        svg.append('g')\n            .attr(\"class\", \"rocnode\")\n            .selectAll(\"rocdot\")\n            .data(data)\n            .join(\"circle\")\n            .attr(\"cx\", function (d, i) { return self.xScale(d.fpr) })\n            .attr(\"cy\", function (d) { return self.yScale(d.tpr) })\n            .attr(\"r\", this.dotRadius)\n\n\n        // svg.selectAll(\".rocdot\")\n        //     .data(data)\n        //     .join(\"circle\") // Uses the enter().append() method\n        //     .attr(\"class\", \"rocdot\") // Assign a class for styling\n        //     .attr(\"cx\", function (d, i) { return self.xScale(d.fpr) })\n        //     .attr(\"cy\", function (d) { return self.yScale(d.tpr) })\n        //     .attr(\"r\", 5)\n\n\n    }\n\n    drawGraph(data) {\n        let self = this\n\n        // data = [\n        //     { \"acc\": 0.7, \"threshold\": 1.2428572177886963, \"tp\": 3, \"tn\": 4, \"fp\": 3, \"fn\": 0, \"ton\": 7, \"top\": 3, \"tpr\": 1, \"fpr\": 0.42857142857142855, \"fnr\": 0, \"tnr\": 0.5714285714285714 },\n        //     { \"acc\": 0.5, \"threshold\": 1.2, \"tp\": 3, \"tn\": 2, \"fp\": 5, \"fn\": 0, \"ton\": 7, \"top\": 3, \"tpr\": 1, \"fpr\": 0.7142857142857143, \"fnr\": 0, \"tnr\": 0.2857142857142857 },\n        //     { \"acc\": 1, \"threshold\": 1.3, \"tp\": 3, \"tn\": 7, \"fp\": 0, \"fn\": 0, \"ton\": 7, \"top\": 3, \"tpr\": 1, \"fpr\": 0, \"fnr\": 0, \"tnr\": 1 },\n        //     { \"acc\": 0.7, \"threshold\": 1.9, \"tp\": 0, \"tn\": 7, \"fp\": 0, \"fn\": 3, \"ton\": 7, \"top\": 3, \"tpr\": 0, \"fpr\": 0, \"fnr\": 1, \"tnr\": 1 },\n        //     { \"acc\": 0.8, \"threshold\": 1.25, \"tp\": 3, \"tn\": 5, \"fp\": 2, \"fn\": 0, \"ton\": 7, \"top\": 3, \"tpr\": 1, \"fpr\": 0.2857142857142857, \"fnr\": 0, \"tnr\": 0.7142857142857143 },\n        //     { \"acc\": 0.8, \"threshold\": 1.8, \"tp\": 1, \"tn\": 7, \"fp\": 0, \"fn\": 2, \"ton\": 7, \"top\": 3, \"tpr\": 0.3333333333333333, \"fpr\": 0, \"fnr\": 0.6666666666666666, \"tnr\": 1 },\n        //     { \"acc\": 0.9, \"threshold\": 1.75, \"tp\": 2, \"tn\": 7, \"fp\": 0, \"fn\": 1, \"ton\": 7, \"top\": 3, \"tpr\": 0.6666666666666666, \"fpr\": 0, \"fnr\": 0.3333333333333333, \"tnr\": 1 },\n        //     { \"acc\": 0.6, \"threshold\": 1.2428570985794067, \"tp\": 3, \"tn\": 3, \"fp\": 4, \"fn\": 0, \"ton\": 7, \"top\": 3, \"tpr\": 1, \"fpr\": 0.5714285714285714, \"fnr\": 0, \"tnr\": 0.42857142857142855 }]\n\n\n        this.setupScalesAxes(data)\n\n        this.rocLine = d3.line()\n            .x(function (d, i) { return self.xScale(d.fpr); }) // set the x values for the line generator\n            .y(function (d) { return self.yScale(d.tpr); }) // set the y values for the line generator \n        // .curve(d3.curveMonotoneX) // apply smoothing to the line\n\n        this.rocArea = d3.area()\n            .x(function (d) { return self.xScale(d.fpr); })\n            .y0(this.chartHeight)\n            .y1(function (d) { return self.yScale(d.tpr); });\n\n\n\n\n        const svg = d3.select(\"div.ROCChart\").append(\"svg\")\n            .attr(\"width\", this.chartWidth + this.chartMargin.left + this.chartMargin.right)\n            .attr(\"height\", this.chartHeight + this.chartMargin.top + this.chartMargin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + this.chartMargin.left + \",\" + this.chartMargin.top + \")\");\n\n        this.drawLines(svg, data)\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n        // 3. Call the x axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + (self.chartHeight + 10) + \")\")\n            .call(customXAxis);\n        // Create an axis component with d3.axisBottom\n\n        // text label for the x axis\n        svg.append(\"text\")\n            .attr(\"transform\",\n                \"translate(\" + (this.chartWidth / 2) + \" ,\" +\n                (this.chartHeight + this.chartMargin.top + 43) + \")\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel x\")\n            .text(\"False Positive Rate\");\n\n\n        // text label for the y axis\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 0 - this.chartMargin.left)\n            .attr(\"x\", 0 - (this.chartHeight / 2))\n            .attr(\"dy\", \"1em\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel y\")\n            .text(\"True Positive Rate\");\n\n\n\n        // 4. Call the y axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(customYAxis); // Create an axis component with d3.axisLeft\n\n    }\n    render() {\n        // console.log(this.props.data.data[his.props.data.data].loss.toFixed(2));\n\n        return (\n            <div className=\"positionrelative mainchartbox \">\n                <div className=\"chartlegend legendtopright p5 mediumdesc \">\n                    <div className=\"mb3 \">\n                        <div className=\"legendcolorbox mr5  themeblue iblock\"></div>\n                        <div ref=\"trainlabel\" className=\"iblock boldtext mr5\"> Area : {this.props.data.auc.toFixed(2)}  </div>\n                        <div className=\"iblock \"> </div>\n                    </div>\n                    <div>\n                        <div className=\"legendcolorbox mr5 redchance iblock\"></div>\n                        <div ref=\"validationlabel\" className=\"iblock boldtext mr5\"> Chance</div>\n                        <div className=\"iblock \"></div>\n                    </div>\n                </div>\n\n\n                <div className=\"ROCChart chartsvg\"> </div>\n            </div>\n\n        );\n    }\n}\n\nexport default ROCChart;    ","import React, { Component } from \"react\";\nimport \"./histogram.css\"\nimport * as d3 from \"d3\"\n\nclass HistogramChart extends Component {\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            chart: this.props.data\n        }\n        this.minChartWidth = this.props.data.chartWidth\n        this.minChartHeight = this.props.data.chartHeight\n\n        this.numTicks = 40\n    }\n\n    componentDidMount() {\n\n        this.drawGraph(this.props.data.data)\n        // console.log(this.props.data); \n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        // console.log(prevProps.data.epoch, this.props.data.epoch)\n        if ((prevProps.data.epoch !== this.props.data.epoch) || (this.props.data.epoch + \"\" === \"0\" || this.props.data.threshold !== prevProps.data.threshold)) {\n            // console.log(\"props updated\");\n            this.updateGraph(this.props.data.data)\n        }\n\n    }\n\n\n    setupScalesAxes(data) {\n        // console.log(data);\n\n        let self = this\n\n        this.chartMargin = { top: 10, right: 5, bottom: 55, left: 45 }\n        this.chartWidth = this.minChartWidth - this.chartMargin.left - this.chartMargin.right\n        this.chartHeight = this.minChartHeight - this.chartMargin.top - this.chartMargin.bottom;\n\n\n\n        this.xScale = d3.scaleLinear()\n            .domain(d3.extent(data, function (d) { return d.mse })).nice()\n            .range([this.chartMargin.left, this.chartWidth - this.chartMargin.right])\n\n        // All Bins\n        this.bins = d3.histogram()\n            .value(function (d) { return d.mse })\n            .domain(this.xScale.domain())\n            .thresholds(this.xScale.ticks(self.numTicks))(data)\n\n        // Normal Bins\n        this.binNorm = d3.histogram()\n            .value(function (d) {\n                if (d.label + \"\" === \"0\") {\n                    return d.mse\n                };\n            })\n            .domain(this.xScale.domain())\n            .thresholds(this.xScale.ticks(self.numTicks))(data)\n\n        // Abnormal Bins\n        this.binsAnorm = d3.histogram()\n            .value(function (d) {\n                if (d.label + \"\" === \"1\") {\n                    return d.mse\n                };\n            })\n            .domain(this.xScale.domain())\n            .thresholds(this.xScale.ticks(self.numTicks))(data)\n\n        // this.xScale = d3.scaleLinear()\n        //     .domain([0, n - 1]) // input\n        //     .range([0, this.chartWidth]); // output\n\n        this.yScale = d3.scaleLinear()\n            .domain([0, d3.max(self.bins, d => d.length)]).nice()\n            .range([this.chartHeight, 0])\n\n        this.xAxis = d3.axisBottom(this.xScale)\n        this.yAxis = d3.axisRight(this.yScale)\n            .tickSize(this.minChartWidth)\n\n\n\n    }\n\n    updateGraph(data) {\n        let self = this\n        // console.log(data[0]);\n\n\n\n\n        this.setupScalesAxes(data)\n\n        let svg = d3.select(\"div.histogramchart\") //.transition();\n        // console.log(svg);\n\n        // // Abnormal Bins\n        svg.select(\".normcolor\")\n            .selectAll(\"rect\")\n            .data(self.binNorm)\n            .join(\"rect\")\n            .attr(\"x\", d => self.xScale(d.x0) + 1)\n            .attr(\"width\", d => Math.max(0, self.xScale(d.x1) - self.xScale(d.x0) - 1))\n            .attr(\"y\", d => self.yScale(d.length))\n            .attr(\"height\", d => self.yScale(0) - self.yScale(d.length))\n        // .transition();\n\n        svg.select(\".anormcolor\")\n            .selectAll(\"rect\")\n            .data(self.binsAnorm)\n            .join(\"rect\")\n            .attr(\"x\", d => self.xScale(d.x0) + 1)\n            .attr(\"width\", d => Math.max(0, self.xScale(d.x1) - self.xScale(d.x0) - 1))\n            .attr(\"y\", d => self.yScale(d.length))\n            .attr(\"height\", d => self.yScale(0) - self.yScale(d.length))\n\n        // Remove previous threshold line\n        // d3.select(\".thresholdline\").transition().duration(5500).style(\"opacity\", 0).remove()\n        // let thresholdVal = this.getThreshold(data)\n        svg.select(\".thresholdline\")\n            .attr(\"x1\", this.xScale(this.props.data.threshold))\n            .attr(\"x2\", this.xScale(this.props.data.threshold))\n\n        svg.select(\".thresholdtext\")\n            .attr(\"x\", this.xScale(this.props.data.threshold))\n            .text(\"Threshold - \" + this.props.data.threshold.toFixed(3));\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n\n        svg.select(\".y.axis\")\n            .call(customYAxis);\n\n        svg.select(\".x.axis\")\n            .call(customXAxis);\n\n\n    }\n\n    getThreshold(data) {\n\n        let meanNormal = d3.mean(data, function (d) {\n            if (d.label + \"\" === \"0\") {\n                return d.mse\n            };\n        })\n\n        let meanAbnormal = d3.mean(data, function (d) {\n            if (d.label + \"\" === \"1\") {\n                return d.mse\n            };\n        })\n\n        let midPoint = (meanNormal + meanAbnormal) / 2\n        let walkBackPercentage = 0.2\n        let thresholdVal = Math.min(meanNormal, meanAbnormal) + (midPoint - Math.min(meanNormal, meanAbnormal)) * walkBackPercentage\n\n\n        return thresholdVal\n    }\n\n    drawGraph(data) {\n        let self = this\n        this.setupScalesAxes(data)\n        // console.log(data[0]);\n\n        const svg = d3.select(\"div.histogramchart\").append(\"svg\")\n            .attr(\"width\", this.chartWidth + this.chartMargin.left + this.chartMargin.right)\n            .attr(\"height\", this.chartHeight + this.chartMargin.top + this.chartMargin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + this.chartMargin.left + \",\" + this.chartMargin.top + \")\");\n\n\n\n        // normal histogram\n        svg.append(\"g\")\n            .attr(\"class\", \"normcolor\")\n            .selectAll(\"rect\")\n            .data(self.binNorm)\n            .join(\"rect\")\n            .attr(\"x\", d => self.xScale(d.x0) + 1)\n            .attr(\"width\", d => Math.max(0, self.xScale(d.x1) - self.xScale(d.x0) - 1))\n            .attr(\"y\", d => self.yScale(d.length))\n            .attr(\"height\", d => self.yScale(0) - self.yScale(d.length));\n\n        // Abnormal histogram\n        svg.append(\"g\")\n            .attr(\"class\", \"anormcolor\")\n            .selectAll(\"rect\")\n            .data(self.binsAnorm)\n            .join(\"rect\")\n            .attr(\"x\", d => self.xScale(d.x0) + 1)\n            .attr(\"width\", d => Math.max(0, self.xScale(d.x1) - self.xScale(d.x0) - 1))\n            .attr(\"y\", d => self.yScale(d.length))\n            .attr(\"height\", d => self.yScale(0) - self.yScale(d.length));\n\n        //add threshold line\n        // let thresholdVal = this.getThreshold(data)\n\n        // threshold line\n        svg.append(\"line\")\n            .attr(\"class\", \"thresholdline\")\n            .attr(\"x1\", this.xScale(this.props.data.threshold))  //<<== change your code here\n            .attr(\"y1\", this.yScale(0))\n            .attr(\"x2\", this.xScale(this.props.data.threshold))  //<<== and here\n            .attr(\"y2\", this.yScale(this.yScale.domain()[1]))\n        // threshold label\n        svg.append(\"text\")\n            .attr(\"class\", \"thresholdtext\")\n            .attr(\"x\", this.xScale(this.props.data.threshold))\n            .attr(\"y\", this.yScale(this.yScale.domain()[1]))\n            .attr(\"dy\", \".95em\")\n            .attr(\"dx\", \".35em\")\n            .text(\"Threshold - \" + this.props.data.threshold.toFixed(3));\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n\n        // text label for the x axis\n        svg.append(\"text\")\n            .attr(\"transform\",\n                \"translate(\" + (this.chartWidth / 2) + \" ,\" +\n                (this.chartHeight + this.chartMargin.top + 43) + \")\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel x\")\n            .text(\"Mean Square Error\");\n\n\n        // text label for the y axis\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 0 - this.chartMargin.left)\n            .attr(\"x\", 0 - (this.chartHeight / 2))\n            .attr(\"dy\", \"1em\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel y\")\n            .text(\"Frequency\");\n\n        // 3. Call the x axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + (self.chartHeight + 10) + \")\")\n            .call(customXAxis); // Create an axis component with d3.axisBottom\n\n        // 4. Call the y axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(customYAxis); // Create an axis component with d3.axisLeft\n\n    }\n\n    render() {\n        return (\n            <div className=\"positionrelative mainchartbox \">\n                <div className=\"chartlegend legendtopleft p5 mediumdesc\">\n                    <div className=\"mb3\"> <div className=\"legendcolorbox mr5  themeblue iblock\"></div> Normal </div>\n                    <div> <div className=\"legendcolorbox mr5 themeorange iblock\"></div> Abnormal </div>\n                </div>\n\n                <div className=\"histogramchart chartsvg\"></div>\n            </div>\n        );\n    }\n}\n\nexport default HistogramChart;","import React, { Component } from \"react\";\nimport \"./scatterplot.css\"\nimport * as d3 from \"d3\"\n\n\nclass ScatterPlot extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            chart: this.props.data\n        }\n        this.minChartWidth = this.props.data.chartWidth\n        this.minChartHeight = this.props.data.chartHeight\n\n        this.numTicks = 40\n    }\n\n    componentDidMount() {\n\n\n        this.drawGraph(this.props.data.data)\n\n        // console.log(this.props.data);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n\n        if ((prevProps.data.epoch !== this.props.data.epoch) || this.props.data.epoch + \"\" === \"0\") {\n            // console.log(\"props updated\");\n            this.updateGraph(this.props.data.data)\n        }\n\n    }\n\n    updateGraph(data) {\n        let self = this\n        // console.log(data[0]);\n\n        d3.select(\"div.scatterplotchart\").selectAll(\".scatternode > *\").remove();\n\n        this.setupScalesAxes(data)\n\n        let svg = d3.select(\"div.scatterplotchart\") //.transition();\n\n        // svg.selectAll(\"dot\").remove()\n\n        svg.select(\".scatternode\")\n            .selectAll(\"dot\")\n            .data(data)\n            .join(\"circle\")\n            .attr(\"cx\", function (d) { return self.xScale(d.x); })\n            .attr(\"cy\", function (d) { return self.yScale(d.y); })\n            .attr(\"r\", 2.5)\n            .attr(\"class\", d => {\n                if (d.label + \"\" === \"0\") {\n                    return \"normcolor\"\n                } else {\n                    return \"anormcolor\"\n                }\n            })\n\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n\n        svg.select(\".y.axis\")\n            .call(customYAxis);\n\n        svg.select(\".x.axis\")\n            .call(customXAxis);\n\n\n\n    }\n    setupScalesAxes(data) {\n        // console.log(data);\n\n        // let self = this\n\n        this.chartMargin = { top: 10, right: 5, bottom: 55, left: 45 }\n        this.chartWidth = this.minChartWidth - this.chartMargin.left - this.chartMargin.right\n        this.chartHeight = this.minChartHeight - this.chartMargin.top - this.chartMargin.bottom;\n\n\n        this.xScale = d3.scaleLinear()\n            .domain([d3.min(data, function (d) { return d.x }), d3.max(data, function (d) { return d.x })]) // input  \n            .range([this.chartMargin.left, this.chartWidth - this.chartMargin.right])\n\n\n\n        this.yScale = d3.scaleLinear()\n            .domain([d3.min(data, function (d) { return d.y }), d3.max(data, function (d) { return d.y })]) // input  \n            .range([this.chartHeight, 0])\n\n        this.xAxis = d3.axisBottom(this.xScale)\n        this.yAxis = d3.axisRight(this.yScale)\n            .tickSize(this.minChartWidth)\n\n\n\n    }\n\n    drawGraph(data) {\n        let self = this\n        this.setupScalesAxes(data)\n\n        const svg = d3.select(\"div.scatterplotchart\").append(\"svg\")\n            .attr(\"width\", this.chartWidth + this.chartMargin.left + this.chartMargin.right)\n            .attr(\"height\", this.chartHeight + this.chartMargin.top + this.chartMargin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + this.chartMargin.left + \",\" + this.chartMargin.top + \")\");\n\n\n        svg.append('g')\n            .attr(\"class\", \"scatternode\")\n            .selectAll(\"dot\")\n            .data(data)\n            .join(\"circle\")\n            .attr(\"cx\", function (d) { return self.xScale(d.x); })\n            .attr(\"cy\", function (d) { return self.yScale(d.y); })\n            .attr(\"r\", 2.5)\n            .attr(\"class\", d => {\n                if (d.label + \"\" === \"0\") {\n                    return \"normcolor\"\n                } else {\n                    return \"anormcolor\"\n                }\n            })\n\n\n        // text label for the x axis\n        svg.append(\"text\")\n            .attr(\"transform\",\n                \"translate(\" + (this.chartWidth / 2) + \" ,\" +\n                (this.chartHeight + this.chartMargin.top + 43) + \")\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel x\")\n            .text(\"Dimension 1\");\n\n\n        // text label for the y axis\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 0 - this.chartMargin.left)\n            .attr(\"x\", 0 - (this.chartHeight / 2))\n            .attr(\"dy\", \"1em\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel y\")\n            .text(\"Dimension 0\");\n\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\")\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n        // 3. Call the x axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + (self.chartHeight + 10) + \")\")\n            .call(customXAxis); // Create an axis component with d3.axisBottom\n\n        // 4. Call the y axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(customYAxis); // Create an axis component with d3.axisLeft\n\n    }\n    render() {\n        return (\n            <div className=\"positionrelative mainchartbox\">\n                <div className=\"chartlegend legendtopleft p5 mediumdesc\">\n                    <div className=\"mb3\"> <div className=\"legendcolorbox mr5  themeblue iblock\"></div> Normal </div>\n                    <div> <div className=\"legendcolorbox mr5 themeorange iblock\"></div> Abnormal </div>\n                </div>\n\n                <div className=\"scatterplotchart\"> </div>\n            </div>\n\n        );\n    }\n}\n\nexport default ScatterPlot;","import React, { Component } from \"react\";\nimport \"./losschart.css\"\nimport * as d3 from \"d3\"\n\n\nclass LossChart extends Component {\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            chart: this.props.data\n        }\n        this.minChartWidth = this.props.data.chartWidth\n        this.minChartHeight = this.props.data.chartHeight\n\n        this.numTicks = 40\n        this.dotRadius = 3.5\n    }\n\n    componentDidMount() {\n        this.drawGraph(this.props.data.data)\n        // console.log(this.props.data.data);\n\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if ((prevProps.data.epoch !== this.props.data.epoch) && this.props.data.data.length > 0) {\n            // console.log(\"props updated\");\n            this.updateGraph(this.props.data.data)\n            this.refs[\"trainlabel\"].innerHTML = this.props.data.data[this.props.data.data.length - 1].loss.toFixed(4)\n            this.refs[\"validationlabel\"].innerHTML = this.props.data.data[this.props.data.data.length - 1].val_loss.toFixed(4)\n            // console.log(this.props.data.data[0].loss, this.refs[\"trainlabel\"]);\n\n        }\n    }\n\n    updateGraph(data) {\n        let self = this\n\n        // d3.select(\"div.losschart\").selectAll(\".lossline\").remove();\n        // d3.select(\"div.losschart\").selectAll(\".pointdot\").remove();\n\n        this.setupScalesAxes(data)\n        let svg = d3.select(\"div.losschart\").transition();\n\n        svg.select(\".losstraincolor\")\n            .duration(self.animationDuration)\n            .attr(\"d\", this.trainLine(data)); // 11. Calls the line generator \n\n        svg.select(\".lossvalcolor\")\n            .duration(self.animationDuration)\n            .attr(\"d\", this.valLine(data)); // 11. Calls the line generator  \n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -30).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n\n        svg.select(\".y.axis\")\n            .call(customYAxis);\n\n        svg.select(\".x.axis\")\n            .call(customXAxis);\n\n    }\n    setupScalesAxes(data) {\n        // console.log(data);\n\n        // let self = this \n        this.chartMargin = { top: 10, right: 10, bottom: 57, left: 45 }\n        this.chartWidth = this.minChartWidth - this.chartMargin.left - this.chartMargin.right\n        this.chartHeight = this.minChartHeight - this.chartMargin.top - this.chartMargin.bottom;\n\n        var n = data.length;\n\n        this.xScale = d3.scaleLinear()\n            .domain([0, n - 1]) // input\n            .range([0, this.chartWidth]); // output\n\n\n        this.yScale = d3.scaleLinear()\n            .domain([d3.min(data, function (d) {\n                // console.log(Math.min(d.loss, d.val_loss))\n                return Math.min(d.loss, d.val_loss)\n            }), d3.max(data, function (d) {\n                return Math.max(d.loss, d.val_loss)\n            })]) // input \n            .range([this.chartHeight, 0])\n\n        this.xAxis = d3.axisBottom(this.xScale)\n        this.yAxis = d3.axisRight(this.yScale)\n            .tickSize(this.minChartWidth)\n    }\n    drawLines(svg, data) {\n\n\n        svg.append(\"path\")\n            .datum(data) // 10. Binds data to the line \n            .attr(\"class\", \"lossline losstraincolor\") // Assign a class for styling  \n            .attr(\"d\", this.trainLine); // 11. Calls the line generator \n\n        svg.append(\"path\")\n            .datum(data) // 10. Binds data to the line \n            .attr(\"class\", \"lossline lossvalcolor\") // Assign a class for styling  \n            .attr(\"d\", this.valLine); // 11. Calls the line generator \n\n    }\n\n    drawGraph(data) {\n        let self = this\n\n\n        // data = [{ epoch: 1, loss: 0.9578104019165039, val_loss: 0.9471035003662109, traintime: 2.247 },\n        // { epoch: 2, loss: 0.7673317790031433, val_loss: 0.8629779815673828, traintime: 0.146 },\n        // { epoch: 3, loss: 0.749285876750946, val_loss: 0.8709790110588074, traintime: 0.152 },\n        // { epoch: 4, loss: 0.7410370707511902, val_loss: 0.8575628995895386, traintime: 0.11 }]\n        // data = [{ epoch: this.CumulativeSteps, loss: 0, val_loss: 0, traintime: 0 }]\n\n        this.setupScalesAxes(data)\n\n        this.trainLine = d3.line()\n            .x(function (d, i) { return self.xScale(i); }) // set the x values for the line generator\n            .y(function (d) { return self.yScale(d.loss); }) // set the y values for the line generator \n            .curve(d3.curveMonotoneX) // apply smoothing to the line\n\n        this.valLine = d3.line()\n            .x(function (d, i) { return self.xScale(i); }) // set the x values for the line generator\n            .y(function (d) { return self.yScale(d.val_loss); }) // set the y values for the line generator \n            .curve(d3.curveMonotoneX) // apply smoothing to the line\n\n\n\n\n        const svg = d3.select(\"div.losschart\").append(\"svg\")\n            .attr(\"width\", this.chartWidth + this.chartMargin.left + this.chartMargin.right)\n            .attr(\"height\", this.chartHeight + this.chartMargin.top + this.chartMargin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + this.chartMargin.left + \",\" + this.chartMargin.top + \")\");\n\n        this.drawLines(svg, data)\n\n        // text label for the x axis\n        svg.append(\"text\")\n            .attr(\"transform\",\n                \"translate(\" + (this.chartWidth / 2) + \" ,\" +\n                (this.chartHeight + this.chartMargin.top + 43) + \")\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel x\")\n            .text(\"Training Steps\");\n\n\n        // text label for the y axis\n        svg.append(\"text\")\n            .attr(\"transform\", \"rotate(-90)\")\n            .attr(\"y\", 0 - this.chartMargin.left - 5)\n            .attr(\"x\", 0 - (this.chartHeight / 2))\n            .attr(\"dy\", \"1em\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"class\", \"axislabel y\")\n            .text(\"Loss\");\n\n        function customYAxis(g) {\n            g.call(self.yAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"stroke\", \"rgba(172, 172, 172, 0.74)\").attr(\"stroke-dasharray\", \"2,2\");\n            g.selectAll(\".tick text\").attr(\"x\", -20).attr(\"y\", -.01)\n        }\n\n        function customXAxis(g) {\n            g.call(self.xAxis);\n            // g.select(\".domain\").remove();\n            g.selectAll(\".tick line\").attr(\"x\", 100)\n            g.selectAll(\".tick text\").attr(\"y\", 15)\n        }\n        // 3. Call the x axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + (self.chartHeight + 10) + \")\")\n            .call(customXAxis); // Create an axis component with d3.axisBottom\n\n        // 4. Call the y axis in a group tag\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(customYAxis); // Create an axis component with d3.axisLeft\n\n    }\n    render() {\n        // console.log(this.props.data.data[his.props.data.data].loss.toFixed(2));\n\n        return (\n            <div className=\"positionrelative mainchartbox \">\n                <div className=\"chartlegend legendtopright p5 mediumdesc\">\n                    <div className=\"mb3\">\n                        <div className=\"legendcolorbox mr5  themeblue iblock\"></div>\n                        <div ref=\"trainlabel\" className=\"iblock boldtext mr5\">0.0</div>\n                        <div className=\"iblock \">Train Loss</div>\n                    </div>\n                    <div>\n                        <div className=\"legendcolorbox mr5 themeorange iblock\"></div>\n                        <div ref=\"validationlabel\" className=\"iblock boldtext mr5\">0.0</div>\n                        <div className=\"iblock \">Validation Loss</div>\n                    </div>\n                </div>\n                <div className=\"losschart chartsvg\"> </div>\n            </div>\n\n        );\n    }\n}\n\nexport default LossChart;    ","import React, { Component } from \"react\";\n// import { Button } from \"carbon-components-react\"\nimport { LeaderLine, animOptions } from \"../helperfunctions/HelperFunctions\"\nimport { Add16, Subtract16 } from '@carbon/icons-react';\nimport \"./composemodel.css\"\nimport * as _ from \"lodash\"\n\nclass ComposeModel extends Component {\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            hiddenDims: this.props.hiddenDims,\n            latentDim: this.props.latentDim,\n            maxLayers: 10,\n            minLayers: 1,\n            maxUnits: 9,\n            minUnits: 2,\n            defaultLayerDim: 3,\n            isTraining: this.props.isTraining,\n            lineWidth: 1.5,\n            latentLineWidth: 2.5,\n            animationDuration: 350\n        }\n\n        this.lineHolder = []\n\n        this.rightTopAnchor = { x: \"100%\", y: \"5%\" }\n        this.rightBottomAnchor = { x: \"100%\", y: \"95%\" }\n        this.leftTopAnchor = { x: 0, y: \"5%\" }\n        this.leftBottomAnchor = { x: \"0%\", y: \"95%\" }\n        this.rightMiddle = { x: \"100%\", y: \"50%\" }\n        this.leftMiddle = { x: \"0%\", y: \"50%\" }\n\n\n        this.blueColor = \"rgba(0, 0, 255, 0.89)\"\n        this.greyColor = \"grey\"\n    }\n    componentDidMount() {\n        this.drawAllLines();\n    }\n\n\n    getElement(network, attributeName, attributeValue) {\n        return document.querySelector(\"div.\" + network).querySelector(\"[\" + attributeName + \"=\" + attributeValue + \"]\")\n    }\n\n    addLayerLines(network, layer) {\n        if ((layer * 1) !== (this.state.hiddenDims.length - 1)) {\n            let startId = \"layerdiv\" + layer;\n            let endId = \"layerdiv\" + (layer * 1 + 1);\n            let startEl = this.getElement(network, \"layerdiv\", startId)\n            let endEl = this.getElement(network, \"layerdiv\", endId)\n            // console.log(startEl, endEl);\n            let params = { pathType: \"straight\", startId: startId, endId: endId, network: network }\n            this.drawLeaderLine(startEl, endEl, network === \"encoder\" ? this.rightTopAnchor : this.leftTopAnchor, network === \"encoder\" ? this.leftTopAnchor : this.rightTopAnchor, params)\n            this.drawLeaderLine(startEl, endEl, network === \"encoder\" ? this.rightTopAnchor : this.leftTopAnchor, network === \"encoder\" ? this.leftBottomAnchor : this.rightBottomAnchor, params)\n            this.drawLeaderLine(startEl, endEl, network === \"encoder\" ? this.rightBottomAnchor : this.leftBottomAnchor, network === \"encoder\" ? this.leftTopAnchor : this.rightTopAnchor, params)\n            this.drawLeaderLine(startEl, endEl, network === \"encoder\" ? this.rightBottomAnchor : this.leftBottomAnchor, network === \"encoder\" ? this.leftBottomAnchor : this.rightBottomAnchor, params)\n        } else {\n            let startId = \"layerdiv\" + layer;\n            let startEl = this.getElement(network, \"layerdiv\", startId)\n            // let encoderDiv = document.getElementById(\"mainencoderdiv\")\n            let latentDiv = document.getElementById(\"latentdiv\")\n            // let decoderDiv = document.getElementById(\"maindecoderdiv\")\n\n            let params = { pathType: \"arc\", startId: startId, endId: \"latent\", network: network }\n            this.drawLeaderLine(startEl, latentDiv, network === \"encoder\" ? this.rightMiddle : this.leftMiddle, network === \"encoder\" ? this.leftMiddle : this.rightMiddle, params)\n\n        }\n    }\n    addEncDecLines(layer) {\n        this.addLayerLines(\"encoder\", layer)\n        this.addLayerLines(\"decoder\", layer)\n    }\n    drawAllLines() {\n        // Add connector lines for encoder decoder \n        for (const layer in this.state.hiddenDims) {\n            this.addEncDecLines(layer)\n\n        }\n    }\n\n\n    removeLayerLines(lineId) {\n\n        // Remove lines associated with a deleted layer\n        // Remove it from the DOM and also from the holder array \n\n\n        let toRemove = new Map()\n        this.lineHolder.forEach(function (each, i) {\n            if (each.startId === lineId || each.endId === lineId) {\n                each.line.remove()\n                toRemove.set(i, \"dot\")\n            } else {\n                each.line.position()\n            }\n        })\n\n        // Remove lines queed up for deletion\n        let newHolder = []\n        this.lineHolder.forEach(function (each, i) {\n            if (toRemove.get(i) == null) {\n                newHolder.push(each)\n            }\n        });\n\n\n        // console.log(\"old\", this.lineHolder.length, newHolder.length);\n        this.lineHolder = newHolder\n\n\n    }\n\n\n    drawLeaderLine(startElement, endElement, startAnchor, endAnchor, params) {\n\n        let lineColor = this.state.isTraining ? \"grey\" : \"rgba(0, 0, 255, 0.89)\"\n        let lineWidth = this.state.lineWidth\n        let plugType = \"disc\"\n\n        let line = new LeaderLine(\n            LeaderLine.pointAnchor(startElement, startAnchor),\n            LeaderLine.pointAnchor(endElement, endAnchor), {\n            color: lineColor,\n            startPlug: plugType,\n            endPlug: plugType,\n            startPlugColor: lineColor,\n            path: params.pathType,\n            size: lineWidth,\n            hide: true,\n            // dash: { gap: 2, animation: params.endId === \"latent\" ? this.state.isTraining : false }\n            dash: { gap: 3 }\n        });\n        // document.querySelector('.leader-line').style.zIndex = -100\n        animOptions.duration = this.state.animationDuration\n        line.show(\"draw\", animOptions)\n        this.lineHolder.push({ line: line, startId: params.startId, endId: params.endId, network: params.network })\n    }\n\n\n    removeAllLines(line) {\n        this.lineHolder.forEach(function (each) {\n            each.line.remove()\n        })\n        this.lineHolder = []\n    }\n\n    redrawAllLines() {\n        this.lineHolder.forEach(function (each) {\n            each.line.position();\n        })\n    }\n\n\n    redrawLine(lineId) {\n        this.lineHolder.forEach(function (each) {\n            if (each.startId === lineId || each.endId === lineId) {\n                // each.line.color = \"red\"\n                each.line.hide(\"none\")\n                each.line.show(\"draw\", animOptions)\n                each.line.position();\n            } else {\n                each.line.position();\n            }\n        })\n    }\n\n    animateLines() {\n        // let self = this\n        let color = this.state.isTraining ? this.greyColor : this.blueColor\n        // console.log(self.props.isTraining);\n        let opt = {\n            color: color,\n            startPlugColor: color\n        }\n\n        this.lineHolder.forEach(function (each) {\n            each.line.setOptions(opt)\n        })\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n\n        // Handle addition of a new node/unit in a layer \n        for (const i in this.state.hiddenDims) {\n            if (this.state.hiddenDims[i] !== prevState.hiddenDims[i]) {\n                this.redrawLine(\"layerdiv\" + i)\n                this.props.updateModelDims(this.state.hiddenDims, this.state.latentDim)\n\n            }\n        }\n\n        // Handle layer addition or removal \n        if (this.state.hiddenDims.length > prevState.hiddenDims.length) {\n            this.removeLayerLines(\"latent\")\n            this.addEncDecLines(this.state.hiddenDims.length - 2)\n            this.addEncDecLines(this.state.hiddenDims.length - 1)\n        } else if (this.state.hiddenDims.length < prevState.hiddenDims.length) {\n            this.removeLayerLines(\"layerdiv\" + this.state.hiddenDims.length)\n            this.addEncDecLines(this.state.hiddenDims.length - 1)\n\n        }\n\n\n        if (prevState.isTraining !== this.props.isTraining) {\n            // console.log(\"training toggled\");\n            this.setState({ isTraining: this.props.isTraining })\n            this.animateLines()\n\n        }\n\n        // Updaate parent state once dims change\n        if (this.state.hiddenDims.length !== prevState.hiddenDims.length || this.state.latentDim[0] !== prevState.latentDim[0]) {\n            // console.log(\"latent or hidden changed\");\n\n            this.props.updateModelDims(this.state.hiddenDims, this.state.latentDim)\n        }\n\n        // console.log(this.lineHolder.length);\n\n        if (prevProps.adv !== this.props.adv) {\n            this.redrawAllLines();\n        }\n\n\n\n\n\n    }\n\n    componentWillUnmount() {\n        this.removeAllLines()\n    }\n\n\n\n    setStateVal(varGroup, newDims) {\n        if (varGroup + \"\" === \"encoder\") {\n            this.setState({ hiddenDims: newDims })\n        } else if (varGroup + \"\" === \"decoder\") {\n            this.setState({ decoderDims: newDims })\n        } else if (varGroup + \"\" === \"latent\") {\n            this.setState({ latentDim: newDims })\n        }\n    }\n\n    getDims(dimType) {\n        switch (dimType) {\n            case \"encoder\":\n                return this.state.hiddenDims.slice()\n            case \"decoder\":\n                return this.state.decoderDims.slice()\n            case \"latent\":\n                return this.state.latentDim.slice()\n            default:\n                break\n        }\n    }\n\n\n\n\n    updateLayerClick(e) {\n\n\n        let currentDims = this.getDims(e.target.getAttribute(\"layergroup\"));\n\n        if (e.target.getAttribute(\"buttonaction\") === \"add\") {\n\n            if (currentDims.length + 1 <= this.state.maxLayers) {\n                currentDims.push(this.state.defaultLayerDim)\n                this.setStateVal(e.target.getAttribute(\"layergroup\"), currentDims)\n            }\n\n        } else {\n\n            if (currentDims.length - 1 >= this.state.minLayers) {\n                currentDims.pop()\n                this.setStateVal(e.target.getAttribute(\"layergroup\"), currentDims)\n            }\n        }\n    }\n\n\n    updateUnits(e) {\n\n        // Update state variables for dimension units\n        let currentDims = this.getDims(e.target.getAttribute(\"layergroup\"));\n        let currentUnit = currentDims[e.target.getAttribute(\"unitindex\") * 1]\n        // console.log(e.target.getAttribute(\"unitindex\"), currentUnit);\n        if (e.target.getAttribute(\"buttonaction\") === \"add\") {\n\n            if (currentUnit + 1 <= this.state.maxUnits) {\n                currentDims[e.target.getAttribute(\"unitindex\") * 1] = currentUnit + 1\n                this.setStateVal(e.target.getAttribute(\"layergroup\"), currentDims)\n            }\n\n        } else {\n\n            if (currentUnit - 1 >= this.state.minUnits) {\n                currentDims[e.target.getAttribute(\"unitindex\") * 1] = currentUnit - 1\n                this.setStateVal(e.target.getAttribute(\"layergroup\"), currentDims)\n            }\n\n        }\n    }\n\n    nodeHover(e) {\n        console.log(e.target.getAttribute(\"nodeunit\"));\n\n    }\n\n\n    render() {\n\n        let latentLayers = this.state.latentDim.map((data, layerindex) => {\n            let eachLayer = _.range(data).map((unitindex) => {\n                return (\n                    <div className={\"eachunitbox \" + (this.state.isTraining ? \" unitgrey\" : \" unitblue\")} key={\"eachunit\" + unitindex}>\n                        {/* {index} */}\n                    </div>\n                )\n            })\n            return (\n                <div key={\"latentlayer\" + layerindex} className=\" h100 flex flexfull flexjustifycenter \">\n                    <div className=\" mwc flex flexjustifycenter mb5 mt5 \">\n                        <div className=\"\" >\n                            <div className=\"smalldesc mb3 unselectable latentunittitle\">{data} units</div>\n                            <div\n                                layergroup=\"latent\"\n                                unitindex={layerindex}\n                                buttonaction=\"add\"\n                                onClick={this.updateUnits.bind(this)}\n                                className=\"updatebutton unselectable mb3 clickable\">\n                                <Add16 className=\"unclickable\"></Add16>\n                            </div>\n                            <div id=\"latentdiv\" className=\"layerdiv  pt3 mb3\">{eachLayer}</div>\n                            <div\n                                layergroup=\"latent\"\n                                unitindex={layerindex}\n                                buttonaction=\"subtract\"\n                                onClick={this.updateUnits.bind(this)}\n                                className=\"updatebutton unselectable  clickable\">\n                                <Subtract16 className=\"unclickable\"></Subtract16>\n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n            )\n        })\n\n        let encLayers = this.state.hiddenDims.map((data, layerindex) => {\n\n            let eachLayer = _.range(data).map((unitindex) => {\n                // console.log(\"layerunit\" + layerindex + unitindex)\n                return (\n                    <div nodeunit={\"layerunit\" + layerindex + unitindex} ref={\"layerunit\" + layerindex + unitindex} className={\"eachunitbox \" + (this.state.isTraining ? \" unitgrey\" : \" unitblue\")} key={\"eachunit\" + unitindex}></div>\n                )\n            })\n            return (\n                <div key={\"enclayer\" + layerindex} className=\"iblock encdecbox  mr10 flex flexfull flexjustifycenter \">\n                    <div className=\"iblock  mb5 mt5\">\n                        <div>\n                            <div className=\"smalldesc mb3 unselectable \">{data} units</div>\n                            <div\n                                layergroup=\"encoder\"\n                                unitindex={layerindex}\n                                buttonaction=\"add\"\n                                onClick={this.updateUnits.bind(this)}\n                                className={\"updatebutton unselectable mb3 clickable \" + (data === this.state.maxUnits ? \" disabled unclickable \" : \"\")}>\n                                <Add16 className=\"unclickable\"> </Add16>\n                            </div>\n                            <div layerdiv={\"layerdiv\" + layerindex} className=\"layerdiv  pt3 mb3\">{eachLayer}</div>\n                            <div\n                                layergroup=\"encoder\"\n                                unitindex={layerindex}\n                                buttonaction=\"subtract\"\n                                onClick={this.updateUnits.bind(this)}\n                                className={\"updatebutton unselectable mb3 clickable \" + (data === this.state.minUnits ? \" disabled unclickable \" : \"\")}>\n                                <Subtract16 className=\"unclickable\"></Subtract16>\n                            </div>\n\n                        </div>\n                    </div>\n                </div >\n            )\n        })\n\n        // console.log(encLayers.length);\n        let decLayers = _.reverse(_.clone(encLayers));\n\n        return (\n            <div className=\"mb10 \">\n\n\n\n                {/* Layer controls */}\n\n                <div className=\"flex w100 mb5 \">\n                    {/* <div className=\"mediumdesc mb5 mt5 mr10\"> * we map the same configuration for both encoder and decoder </div> */}\n                    <div className=\"flex5 \">\n                        <div className=\"smalldesc networktitle  p5\"> Encoder {this.state.hiddenDims.length} Layers </div>\n                    </div>\n                    <div className=\"buttonbar mr10 ml10 \">\n                        <div\n                            layergroup=\"encoder\"\n                            buttonaction=\"add\"\n                            onClick={this.updateLayerClick.bind(this)}\n                            className={\"updatebutton unselectable mr5 clickable \" + (this.state.hiddenDims.length === this.state.maxLayers ? \" disabled unclickable \" : \"\")}>\n                            <Add16 className=\"unclickable\"></Add16>\n                        </div>\n                        <div\n                            layergroup=\"encoder\"\n                            buttonaction=\"subtract\"\n                            onClick={this.updateLayerClick.bind(this)}\n                            className={\"updatebutton unselectable  clickable \" + (this.state.hiddenDims.length === this.state.minLayers ? \" disabled unclickable \" : \"\")}>\n                            <Subtract16 className=\"unclickable\"></Subtract16>\n                        </div>\n                    </div>\n                    <div className=\"unselectable flex5     \">\n                        <div className=\"flex p5 networktitle  mediumdesc \">\n                            <div className=\"flex flexjustifyleft \"> </div>\n                            <div className=\"flex flexfull flexjustifycenter   \"></div>\n                            <div className=\"smalldesc\"> Decoder {this.state.hiddenDims.length} Layers </div>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Section titles */}\n                <div className=\"flex mb10 displaynone\">\n                    <div className=\"flex4 textaligncenter mediumdesc boldtext\"> Encoder </div>\n                    <div className=\"flex2 textaligncenter  mediumdesc boldtext\"> Bottleneck </div>\n                    <div className=\"flex4 textaligncenter  mediumdesc boldtext\"> Decoder </div>\n                </div>\n                {/* Encoder, bottleneck, Decoder  */}\n                <div className=\"flex\">\n                    <div className=\"iotextdata unselectable mr10 p5  \">\n                        input\n                    </div>\n                    <div id=\"mainencoderdiv\" ref=\"encoderbox\" className=\"encoder greyhighlight  pl5 flex5 mr10 \">\n                        <div className=\"layerbar flex  flexjustifycenter pb10 pt10\">\n                            {encLayers}\n                        </div>\n\n                    </div>\n                    <div ref=\"latentbox\" className=\"bottlneck pr5 pl5   mr10 \">\n                        <div className=\"layerbar  h100  flex  flexjustifycenter  \">\n                            {latentLayers}\n                        </div>\n                    </div>\n                    <div id=\"maindecoderdiv\" ref=\"decoderbox\" className=\"decoder greyhighlight  pl5 flex5 \">\n                        <div className=\"layerbar flex   flexjustifycenter  pb10 pt10\">\n                            {decLayers}\n                        </div>\n                    </div>\n\n                    <div className=\"iotextdata unselectable ml10 p5  \">\n                        output\n                    </div>\n\n                </div>\n\n            </div>\n        );\n    }\n}\n\nexport default ComposeModel;","// Craft an autoencoder\n\n// const tf = require('@tensorflow/tfjs');\n// Craft an autoencoder\n\nconst tf = require('@tensorflow/tfjs');\n// const _ = require('lodash');\n\n\n\nexport function buildModel(params) {\n\n    const numFeatures = params.numFeatures    // Set feaetures to size of features \n    const latentDim = params.latentDim\n    const hiddenDim = params.hiddenDim\n    const outputActivation = params.outputActivation\n    const regularizationRate = params.regularizationRate\n    let layerRegularizer = null\n    // const\n    if (params.regularizer === \"l1\") {\n        layerRegularizer = tf.regularizers.l1({ l1: regularizationRate })\n\n    } else if (params.regularizer === \"l2\") {\n        layerRegularizer = tf.regularizers.l2({ l2: regularizationRate })\n\n    } else if (params.regularizer === \"l1l2\") {\n        layerRegularizer = tf.regularizers.l1l2({ l1: regularizationRate, l2: regularizationRate })\n    }\n\n\n    // Specify encoder \n    // const input = tf.input({ shape: [numFeatures] })\n    // let encoderHidden = tf.layers.dense({ units: 15, activation: \"relu\" }).apply(input);\n    // encoderHidden = tf.layers.dense({ units: 7, activation: \"relu\" }).apply(encoderHidden);\n    // const z_ = tf.layers.dense({ units: latentDim }).apply(encoderHidden);\n    // const encoder = tf.model({ inputs: input, outputs: z_, name: \"encoder\" })\n\n    const input = tf.input({ shape: [numFeatures] })\n    let encoderHidden = tf.layers.dense({ units: hiddenDim[0], activation: \"relu\", kernelRegularizer: layerRegularizer }).apply(input);\n    let i = 1\n    while (i < hiddenDim.length) {\n        encoderHidden = tf.layers.dense({ units: hiddenDim[i], activation: \"relu\", kernelRegularizer: layerRegularizer }).apply(encoderHidden);\n        i++\n    }\n    const z_ = tf.layers.dense({ units: latentDim }).apply(encoderHidden);\n    const encoder = tf.model({ inputs: input, outputs: z_, name: \"encoder\" })\n\n\n\n    const latentInput = tf.input({ shape: [latentDim] })\n    let decoderHidden = tf.layers.dense({ units: hiddenDim[hiddenDim.length - 1], activation: \"relu\", kernelRegularizer: layerRegularizer }).apply(latentInput);\n    let j = hiddenDim.length - 1\n    while (j > 0) {\n        j--;\n        decoderHidden = tf.layers.dense({ units: hiddenDim[j], activation: \"relu\", kernelRegularizer: layerRegularizer }).apply(decoderHidden);\n\n    }\n\n    const decoderOutput = tf.layers.dense({ units: numFeatures, activation: outputActivation }).apply(decoderHidden);\n    const decoder = tf.model({ inputs: latentInput, outputs: decoderOutput, name: \"decoder\" })\n\n    // link output of ender to decoder \n    let output = decoder.apply(encoder.apply(input))\n\n    // Construct AE with both encoder and decoder\n    const ae = tf.model({ inputs: input, outputs: output, name: \"autoencoder\" })\n\n\n    ae.compile({ optimizer: params.optimizer, loss: \"meanSquaredError\" })\n    return ae\n}\n\n\n","import React, { Component } from \"react\";\nimport {Loading,Dropdown, Slider, Checkbox, Tooltip } from \"carbon-components-react\"\nimport \"./train.css\"\nimport * as tf from '@tensorflow/tfjs';\nimport { computeAccuracyGivenThreshold, percentToRGB } from \"../helperfunctions/HelperFunctions\"\nimport ROCChart from \"../rocchart/ROCChart\"\n// custom charts \nimport HistogramChart from \"../histogram/HistogramChart\"\nimport ScatterPlot from \"../scatterplot/ScatterPlot\"\nimport LossChart from \"../losschart/LossChart\"\nimport ComposeModel from \"../composemodel/ComposeModel\"\n\nimport { Reset16, PlayFilledAlt16, PauseFilled16 } from '@carbon/icons-react';\nimport { buildModel } from \"./models/ae\"\nimport * as _ from \"lodash\"\n\n// const _ = require('lodash');\nclass Train extends Component {\n\n    constructor(props) {\n        super(props)\n\n       \n        // tf.webgl.forceHalfFloat()\n\n        this.chartWidth = 350;\n        this.chartHeight = 250;\n\n        \n        \n        // Load sameple data\n        this.testData = require(\"../../data/ecg/test_scaled.json\")\n      \n        \n\n        // this.testData = [{\"data\":[1,2,3,3]}]\n        // this.trainData = [{\"data\":[1,2,3,3]}]\n        // this.dummyMSe = require(\"../../data/dummy/mse.json\")\n\n        // Model update method passed to model composer component\n        this.updateModelDims = this.updateModelDims.bind(this)\n\n        this.stepOptions = [{ id: \"opt1\", text: \"50\", value: 50, type: \"steps\" }, { id: \"opt2\", text: \"100\", value: 100, type: \"steps\" }]\n        this.regularizerOptions = [{ id: \"opt1\", text: \"None\", value: \"none\", type: \"regularizer\" }, { id: \"opt1\", text: \"l1\", value: \"l1\", type: \"regularizer\" }, { id: \"opt2\", text: \"l2\", value: \"l2\", type: \"regularizer\" }, { id: \"opt2\", text: \"l1l2\", value: \"l1l2\", type: \"regularizer\" }]\n        this.batchSizeOptions = [{ id: \"opt1\", text: \"64\", value: 64, type: \"batchsize\" }, { id: \"opt2\", text: \"128\", value: 128, type: \"batchsize\" }, { id: \"opt3\", text: \"256\", value: 256, type: \"batchsize\" }, { id: \"opt3\", text: \"512\", value: 512, type: \"batchsize\" }, { id: \"opt3\", text: \"1024\", value: 1024, type: \"batchsize\" }]\n        this.learningRateOptions = [{ id: \"opt1\", text: \"0.01\", value: 0.01, type: \"learningrate\" }, { id: \"opt2\", text: \"0.001\", value: 0.001, type: \"learningrate\" }, { id: \"opt3\", text: \"0.0001\", value: 0.0001, type: \"learningrate\" },{ id: \"opt5\", text: \"0.1\", value: 0.1, type: \"learningrate\" },{ id: \"opt6\", text: \"1\", value: 1, type: \"learningrate\" },{ id: \"opt7\", text: \"10\", value: 10, type: \"learningrate\" }]\n        // this.regularizationRateOptions = [ \n        //     { id: \"opt3\", text: \"0.01\", value: 0.01, type: \"regularizationrate\" },\n        //     { id: \"opt1\", text: \"0.001\", value: 0.001, type: \"regularizationrate\" },\n        //     { id: \"opt2\", text: \"0.0001\", value: 0.0001, type: \"regularizationrate\" }, \n        // ]\n        this.trainingDataOptions = [{ id: \"opt1\", text: \"500\", value: 500, type: \"traindatasize\" }, { id: \"opt2\", text: \"1000\", value: 1000, type: \"traindatasize\" }, { id: \"opt3\", text: \"2500\", value: 2500, type: \"traindatasize\" }]\n        this.testDataOptions = [{ id: \"opt1\", text: \"100\", value: 100, type: \"testdatasize\" }, { id: \"opt2\", text: \"200\", value: 200, type: \"testdatasize\" }, { id: \"opt3\", text: \"500\", value: 500, type: \"testdatasize\" }]\n        this.optimizerOptions = [\n            { id: \"opt1\", text: \"Adam\", value: \"adam\", type: \"optimizer\" },\n            { id: \"opt3\", text: \"Adamax\", value: \"adamax\", type: \"optimizer\" },\n            { id: \"opt4\", text: \"Adadelta\", value: \"adadelta\", type: \"optimizer\" },\n            { id: \"opt5\", text: \"Rmsprop\", value: \"rmsprop\", type: \"optimizer\" },\n            { id: \"opt6\", text: \"Momentum\", value: \"momentum\", type: \"optimizer\" },\n            { id: \"opt7\", text: \"sgd\", value: \"sgd\", type: \"optimizer\" },\n        ]\n        this.abnormalPercentageOptions = [\n            { id: \"opt1\", text: \"0%\", value: 0, type: \"abnormalpercentage\" },\n            { id: \"opt3\", text: \"5%\", value: 0.05, type: \"abnormalpercentage\" },\n            { id: \"opt4\", text: \"10%\", value: 0.1, type: \"abnormalpercentage\" },\n            { id: \"opt5\", text: \"20%\", value: 0.2, type: \"abnormalpercentage\" },\n            { id: \"opt2\", text: \"30%\", value: 0.3, type: \"abnormalpercentage\" },\n            { id: \"opt6\", text: \"50%\", value: 0.5, type: \"abnormalpercentage\" },\n            { id: \"opt7\", text: \"70%\", value: 0.7, type: \"abnormalpercentage\" },\n        ]\n \n\n        this.selectedAbnormalPercentage = 0\n        this.selectedTrainDataOption = 0\n        this.selectedTestDataOption = 2\n        this.selectedOptimizer = 0\n\n        this.selectedRegularizer = 0\n\n        this.trainMetricHolder = []\n        this.CumulativeSteps = 0;\n\n        this.state = {\n            apptitle: \"Anomagram\",\n            isTraining: false,\n            trainDataShape: [0, 0],\n            testDataShape: [0, 0],\n            mseData: [],\n            rocData: [],\n            createdModel: null,\n            encodedData: [],\n            selectedData: 0,\n\n            currentEpoch: 0,\n            numFeatures: this.testData[0].data.length,\n            hiddenLayers: 2,\n            latentDim: 2,\n            hiddenDim: [7, 3],\n            learningRate: this.learningRateOptions[0].value,\n            regularizer: this.regularizerOptions[this.selectedRegularizer].value,\n            adamBeta1: 0.5,\n            optimizer: this.optimizerOptions[this.selectedOptimizer].value,\n            outputActivation: \"sigmoid\",\n            batchSize: this.batchSizeOptions[3].value,\n            numSteps: this.stepOptions[0].value,\n            numEpochs: 1,\n\n\n            trainMetrics: this.trainMetricHolder,\n            CumulativeSteps: 0,\n            trainDataSize: this.trainingDataOptions[this.selectedTrainDataOption].value,\n            testDataSize: this.testDataOptions[this.selectedTestDataOption].value,\n\n            modelStale: true,\n            bestMetric: { acc: 0, fpr: 0, fnr: 0, tnr: 0, tpr: 0, threshold: 0 },\n            minThreshold: 0,\n            maxThreshold: 1,\n\n\n            showModelComposer: true,\n            showModelEvaluationMetrics: true,\n            showRocChart: true,\n            showLossChart: true,\n            showMseHistogram: true,\n            showBottleneckScatterPlot: true,\n\n\n            validateOnStep: true,\n            auc: 0,\n\n\n            showAdvanced: true,\n            showIntroduction: true,\n            showWarmingUp: true,\n\n            \n            lossChartHeight: this.chartHeight,\n            lossChartWidth: this.chartWidth,\n            abnormalPercentage: this.abnormalPercentageOptions[this.selectedAbnormalPercentage].value,\n\n            floatCapable: false,\n            floatEnabled: false,\n            isCreating: false,\n        }\n\n        this.showOptions = [\n            { label: \"Model Composer\", action: \"composer\", checked: this.state.showModelComposer },\n            { label: \"Model Metrics\", action: \"evaluation\", checked: this.state.showModelEvaluationMetrics }, { label: \"Training Loss\", action: \"loss\", checked: this.state.showLossChart },\n            { label: \"Error Histogram\", action: \"histogram\", checked: this.state.showMseHistogram },\n            { label: \"ROC Curve\", action: \"roc\", checked: this.state.showRocChart },\n            { label: \"Bottleneck Plot\", action: \"bottleneck\", checked: this.state.showBottleneckScatterPlot },\n\n        ]\n\n\n        this.currentSteps = 0;\n\n        this.xsTrain = []\n        this.xsTest = []\n        this.yTest = []\n\n        this.trainDataPath = \"data/ecg/train.json\"\n        this.testDataPath = \"data/ecg/test.json\" \n        this.momentum = 0.9 \n\n        this.modelWarmedUp = false;\n        this.tensorsCreated = false;\n\n        this.trainUnmounted = false\n    }\n\n    componentDidMount() {\n        // this.loadSavedModel() \n        // this.computeAccuracyMetrics(this.dummyMSe)\n\n        // setTimeout(() => {\n        //     // this.createModel()\n        // }, 100);\n        this.trainData = require(\"../../data/ecg/train_scaled.json\") \n       \n\n        this.getChartContainerSizes()\n\n        // this.setState({\n        //     floatCapable: tf.ENV.getBool('WEBGL_RENDER_FLOAT32_CAPABLE'),\n        //     floatEnabled: tf.ENV.getBool('WEBGL_RENDER_FLOAT32_ENABLED')\n        // }) \n\n\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        if ((prevState.isTraining !== this.state.isTraining) && this.state.isTraining === false) {\n            // console.log(\"training ended\"); \n        }\n\n        if (this.currentSteps === 0 && prevState.mseData[0] !== this.state.mseData[0]) {\n            // console.log(\"mse updated at 0\");\n            this.computeAccuracyMetrics(this.state.mseData)\n        }\n\n        if (this.state.CumulativeSteps !== prevState.CumulativeSteps) {\n            // console.log(this.state.CumulativeSteps);\n            this.computeAccuracyMetrics(this.state.mseData)\n        }\n\n        // if train or test size updated, regenerate tensors\n        if (this.state.trainDataSize !== prevState.trainDataSize || this.state.testDataSize !== prevState.testDataSize || this.state.abnormalPercentage !== prevState.abnormalPercentage ) {\n            this.generateDataTensors()\n        }\n    }\n\n\n    destroyModelTensors() {\n        // Dispose all tensors used to hold model parameters\n        if (this.createdModel) {\n            // this.encoder.dispose()\n            this.createdModel.dispose()\n            this.optimizer.dispose() \n        }\n    }\n\n    componentWillUnmount() {\n        this.trainUnmounted = true\n        if (this.tensorsCreated) {\n            this.xsTest.dispose()\n            this.xsTrain.dispose() \n            this.destroyModelTensors()\n        }\n         \n        // this.xsWarmup.dispose()\n        // console.log(tf.memory()); \n    }\n    createModel() { \n\n        // dispose of existing model to release tensors from memory\n        this.destroyModelTensors()\n\n        // if Data tensors not created at all, create tensors \n        if (!this.tensorsCreated) {\n            this.generateDataTensors()\n            this.tensorsCreated = true\n        } \n\n        //construct model\n        switch (this.state.optimizer) {\n            case \"adam\":\n                this.optimizer = tf.train.adam(this.state.learningRate, this.state.adamBeta1)\n                break\n            case \"adamax\":\n                this.optimizer = tf.train.adamax(this.state.learningRate, this.state.adamBeta1)\n                break\n            case \"adadelta\":\n                this.optimizer = tf.train.adadelta(this.state.learningRate)\n                break\n            case \"rmsprop\":\n                this.optimizer = tf.train.rmsprop(this.state.learningRate)\n                break\n            case \"momentum\":\n                this.optimizer = tf.train.momentum(this.state.learningRate, this.momentum)\n                break\n            case \"sgd\":\n                this.optimizer = tf.train.sgd(this.state.learningRate)\n                break\n            default:\n                break;\n        }\n\n\n\n        let modelParams = {\n            numFeatures: this.state.numFeatures,\n            hiddenLayers: this.state.hiddenLayers,\n            latentDim: this.state.latentDim,\n            hiddenDim: this.state.hiddenDim,\n            optimizer: this.optimizer,\n            outputActivation: \"sigmoid\",\n            regularizer: this.state.regularizer,\n            regularizationRate: this.state.learningRate\n        }\n\n        this.createdModel = buildModel(modelParams)\n        this.setState({ modelStale: false, isCreating:false })\n        this.getPredictions()\n\n        \n        \n\n\n        // this.createdModel.summary()\n\n        // setTimeout(() => {\n        // this.modelWarmUp()\n        // }, 5000);\n\n        // showToast(\"success\", \"Model successfully created\")\n        // console.log(tf.memory());\n        // this.setState({showWarmingUp: false})\n    }\n\n    warmUpModel() {\n\n        // let warmUpTensor = tf.tensor2d(this.trainData[0].data,[1,140])\n         console.log(\"attempting warmup\");\n         \n        let warmUpTensor =  tf.tensor2d(this.trainData.slice(0,10).map(item => item.data\n            ), [10, this.trainData[0].data.length])\n        this.setState({ trainDataShape: this.xsTrain.shape })\n        \n        let startTime = new Date();\n        this.createdModel.fit(warmUpTensor, warmUpTensor, { epochs: 1, verbose: 0, batchSize: 512}\n        ).then(res => {\n            let endTime = new Date();\n            let elapsedTime = (endTime - startTime) / 1000\n            console.log(\"Warmup done\", elapsedTime);\n        });\n\n    }\n    trainModel() {\n        // for (let i = 0; i < this.numSteps; i++) {\n\n        this.currentSteps++;\n        //update progresssbar\n        // let progress = Math.floor((this.currentSteps / this.state.numSteps) * 100) + \"%\"\n        // this.refs[\"glowbar\"].style.width = progress;\n\n\n\n        this.CumulativeSteps++;\n        this.setState({ CumulativeSteps: this.CumulativeSteps });\n        // \n        let startTime = new Date();\n        this.createdModel.fit(this.xsTrain,\n            this.xsTrain, { epochs: this.state.numEpochs, verbose: 0, batchSize: this.state.batchSize, validationData: [this.xsTest, this.xsTest] }\n        ).then(res => {\n            let endTime = new Date();\n            let elapsedTime = (endTime - startTime) / 1000\n            // console.log(elapsedTime);\n\n            let metricRow = { epoch: this.CumulativeSteps, loss: res.history.loss[0], val_loss: res.history.val_loss[0], traintime: elapsedTime }\n            this.trainMetricHolder.push(metricRow)\n            // this.setState({ trainMetrics: this.trainMetricHolder });\n            // console.log(\"Step loss\", this.currentSteps, this.CumulativeSteps, res.history.loss[0], elapsedTime);\n           \n\n            // console.log(this.state.numSteps);\n\n            if (this.state.numSteps > this.currentSteps && this.state.isTraining && !this.trainUnmounted  && (!this.state.modelStale)) {\n                this.getPredictions();\n                this.setState({ currentEpoch: this.currentSteps })\n                this.trainModel()\n            } else {\n                this.currentSteps = 0\n                this.setState({ isTraining: false })\n            }\n        });\n    }\n\n    async loadSavedModel() {\n        // TODO .. launch loadning spinnr\n        let modelPath = \"/webmodel/ecg/model.json\"\n        this.savedModel = await tf.loadLayersModel(modelPath);\n        console.log(\"model loaded\");\n        this.loadTestData()\n\n    }\n\n\n    computeAccuracyMetrics(data) {\n\n        let uniqueMse = _.uniq(_.map(data, 'mse'))\n\n        uniqueMse = _(uniqueMse).sortBy().value()\n        uniqueMse.reverse()\n\n\n\n\n        let rocMetricHolder = []\n        let rocSum = 0\n        let prevMetric = { fpr: 0, tpr: 0 }\n\n        uniqueMse.forEach((each, i) => {\n            let metric = computeAccuracyGivenThreshold(data, each)\n\n            rocMetricHolder.push(metric)\n            // if (i < uniqueMse.length) {\n            // rocSum += (prevMetric.tpr) * (metric.fpr - prevMetric.fpr)\n            rocSum += ((prevMetric.tpr + metric.tpr) / 2) * (metric.fpr - prevMetric.fpr)\n            // console.log(i, rocSum);\n            // }\n            prevMetric = metric\n\n        });\n\n        // Add point (1,1) to compute AUC\n        // use trapezium area rule to calculate area\n        if (prevMetric.fpr !== 1) {\n            rocMetricHolder.push({ fpr: 1, tpr: prevMetric.tpr })\n            rocSum += ((prevMetric.tpr + 1) / 2) * (1 - prevMetric.fpr)\n            // rocSum += prevMetric.tpr * (1 - prevMetric.fpr)\n        }\n\n\n        // console.log(rocSum, \" Region under curve\");\n        // console.log(rocMetricHolder);\n\n\n        this.setState({ rocData: rocMetricHolder })\n        this.setState({ auc: rocSum })\n        // console.log(\"mse initial\", _.min(uniqueMse), _.max(uniqueMse));\n\n        let bestMetric = _.maxBy(rocMetricHolder, \"acc\")\n        this.setState({ bestMetric: bestMetric })\n        this.setState({ minThreshold: _.min(uniqueMse) })\n        this.setState({ maxThreshold: _.max(uniqueMse) })\n\n\n    }\n\n\n    getPredictions() {\n        let self = this;\n\n        // Get predictions \n        // let startTime = new Date()\n        let preds = this.createdModel.predict(this.xsTest, { batchSize: this.state.batchSize })\n        // let elapsedTime = (new Date() - startTime) / 1000\n        // console.log(\"prediction time\", elapsedTime);\n\n\n        //With large batchsize - 0.001, defualt batchsize .. 0.015\n        // Compute mean squared error difference between predictions and ground truth\n        const mse = tf.tidy(() => {\n            return tf.sub(preds, this.xsTest).square().mean(1)\n        })\n        // let mse = tf.sub(preds, this.xsTest).square().mean(1) //tf.losses.meanSquaredError(preds, xsTest)\n        let mseDataHolder = []\n        mse.array().then(array => {\n            array.forEach((element, i) => {\n                // console.log({ \"mse\": element, \"label\": yTest[i] });\n                mseDataHolder.push({ \"mse\": element, \"label\": this.yTest[i] })\n                // console.log(mseDataHolder.length)\n            });\n            self.setState({ mseData: mseDataHolder })\n\n            // console.log(mseDataHolder);\n\n        });\n\n\n\n        // Generate encoder output \n        this.encoder = tf.model({ inputs: this.createdModel.inputs, outputs: this.createdModel.getLayer(\"encoder\").getOutputAt(1) });\n        let encoderPredictions = this.encoder.predict(this.xsTest)\n\n\n        let encPredHolder = []\n        encoderPredictions.array().then(array => {\n            array.forEach((element, i) => {\n                encPredHolder.push({ x: element[0], y: element[1], \"label\": this.yTest[i] })\n            });\n            self.setState({ encodedData: encPredHolder })\n        })\n\n\n        preds.dispose()\n        encoderPredictions.dispose()\n        mse.dispose()\n        // console.log(tf.memory());\n\n    }\n\n    updateModelDims(hiddenDims, latentDim) {\n        // console.log(hiddenDims, latentDim);\n        this.setState({ hiddenDim: hiddenDims })\n        this.setState({ latentDim: latentDim[0] })\n        this.setState({ modelStale: true })\n\n    }\n\n    // visualizeMSE(mse)\n    generateDataTensors() {\n        console.log(\"Generating data tensor\");\n        \n        //shuffle data\n        this.trainData = _.shuffle(this.trainData)\n        this.testData = _.shuffle(this.testData)\n\n        let maxAbnormalCount = this.state.abnormalPercentage * this.state.trainDataSize;\n        let abnormalCount = 0;\n\n        let trainEcg = []\n        //Add abnormal samples\n        for (let row in this.trainData) {\n            let val = this.trainData[row] \n            if (val.target + \"\" !== 1 + \"\") {\n                if (abnormalCount < maxAbnormalCount) {\n                    trainEcg.push(val)\n                    abnormalCount++\n                }\n            }\n        }\n\n        //Add  positive normal ECG (target==1) to train json array \n        for (let row in this.trainData) {\n            let val = this.trainData[row]\n            if (val.target + \"\" === 1 + \"\") { \n                if (trainEcg.length < this.state.trainDataSize) {\n                    trainEcg.push(val)\n                } else {\n                    break\n                }\n            }  \n        }\n\n        // console.log(maxAbnormalCount, \"abnormal samples\",  abnormalCount, \"Total\", trainEcg.length);\n        \n\n        // Create train tensor from json array\n        this.xsTrain = tf.tensor2d(trainEcg.map(item => item.data\n        ), [trainEcg.length, trainEcg[0].data.length])\n        this.setState({ trainDataShape: this.xsTrain.shape })\n\n\n        // Create test data TENSOR from test data json array \n        let testData = this.testData.slice(0, this.state.testDataSize)\n        this.xsTest = tf.tensor2d(testData.map(item => item.data\n        ), [testData.length, testData[0].data.length])\n\n        // Create yLabel Tensor\n        this.yTest = testData.map(item => item.target + \"\" === 1 + \"\" ? 0 : 1)\n\n        this.setState({ testDataShape: this.xsTest.shape })\n\n    }\n\n    trainButtonClick(e) {\n        if (this.state.isTraining) {\n            this.setState({ isTraining: false })\n        } else {\n            this.setState({ isTraining: true })\n            setTimeout(() => {\n                this.trainModel()\n            }, 700);\n        }\n    }\n\n    resetModelButtonClick(e) { \n        this.CumulativeSteps = 0 \n        this.trainMetricHolder = []\n        this.setState({\n            // showIntroduction: false,\n            isCreating: true,\n            isTraining: false,\n            CumulativeSteps: 0,\n            trainMetrics: this.trainMetricHolder \n        })\n          \n       \n        // this.setState({ mseData: [] }) \n        setTimeout(() => {\n            this.createModel()\n        }, 700);\n        \n    }\n\n    updateModelParam(e) {\n        // model state is set to stale each time a parameter is updated.\n        this.setState({ modelStale: true })\n        switch (e.selectedItem.type) {\n            case \"steps\":\n                this.setState({ numSteps: e.selectedItem.value })\n                break\n            case \"batchsize\":\n                this.setState({ batchSize: e.selectedItem.value }) \n                break\n            case \"learningrate\":\n                this.setState({ learningRate: e.selectedItem.value }) \n                break\n            case \"traindatasize\":\n                this.setState({ trainDataSize: e.selectedItem.value }) \n                break\n            case \"abnormalpercentage\":\n                    this.setState({ abnormalPercentage: e.selectedItem.value }) \n                    break\n            case \"testdatasize\":\n                this.setState({ testDataSize: e.selectedItem.value })\n                break\n            case \"optimizer\":\n                this.setState({ optimizer: e.selectedItem.value }) \n                break\n            case \"regularizer\":\n                this.setState({ regularizer: e.selectedItem.value }) \n                break\n            default:\n                break\n        }\n\n\n    }\n\n\n    updateThreshold(e) {\n        if (this.state.mseData.length > 0) {\n            let threshVal = this.state.minThreshold + (e.value / 100) * (this.state.maxThreshold - this.state.minThreshold)\n            let bestMetric = computeAccuracyGivenThreshold(this.state.mseData, threshVal)\n            // console.log(e.value, this.state.mseData);\n            this.setState({ bestMetric: bestMetric })\n        }\n\n    }\n\n    \n\n    showOptionsClick(e) {\n        // console.log(e.target.checked, e.target.getAttribute(\"action\"));\n        switch (e.target.getAttribute(\"action\")) {\n            case \"histogram\":\n                this.setState({ showMseHistogram: e.target.checked })\n                break\n            case \"loss\":\n                this.setState({ showLossChart: e.target.checked })\n                break\n            case \"composer\":\n                this.setState({ showModelComposer: e.target.checked })\n                break\n            case \"bottleneck\":\n                this.setState({ showBottleneckScatterPlot: e.target.checked })\n                break\n            case \"roc\":\n                this.setState({ showRocChart: e.target.checked })\n                break\n            case \"evaluation\":\n                this.setState({ showModelEvaluationMetrics: e.target.checked })\n                break\n            default:\n                break\n        }\n\n    }\n\n    toggleAdvancedDrawer(e) {\n        this.setState({ showAdvanced: !(this.state.showAdvanced) })\n    }\n\n    toggleIntroDrawer(e) {\n        this.setState({ showIntroduction: !(this.state.showIntroduction) })\n    }\n \n    getChartContainerSizes() {\n        \n\n        this.setState({ lossChartHeight: this.refs[\"modelevalbox\"].offsetHeight-  50 })\n        // this.setState({lossChartWidth: this.refs[\"modelevalbox\"].offsetWidth })\n         \n        \n    }\n\n    render() {\n        // console.log(this.state.minThreshold, this.state.maxThreshold);\n        \n        // Use chart state determine when to redraw model composer lines as UI has change\n        let chartState = \"\"\n        this.showOptions.forEach(data => {\n            let box = document.getElementById(data.action + \"checkboxid\")\n            if (box !== null) {\n                chartState += box.checked \n            } \n        }); \n\n        \n\n        //get size of chart containers\n       \n         \n\n        let showCheckBoxes = this.showOptions.map((data) => {\n            return (\n                <div key={data.label + \"checkbox\"} className=\"mediumdesc iblock mr10\">\n                    <Checkbox\n                        defaultChecked={data.checked}\n                        wrapperClassName={\"mediumdesc chartchecks\"}\n                        className={\"mediumdesc \"}\n                        labelText={data.label}\n                        id={data.action + \"checkboxid\"}\n                        action={data.action}\n                        onClick={this.showOptionsClick.bind(this)}\n                    ></Checkbox>\n                </div>\n            )\n        })\n\n        let trainResetButtons = (\n            <div>\n                <div className=\"  flex flexjustifycenter pt10 \">\n\n                   \n\n                    <div className=\"iblock h100 mr5 \">\n                        <div className=\"  flex flexjustifycenter h100  \">\n                            <div className=\"\">\n                                <div\n                                    onClick={this.resetModelButtonClick.bind(this)}\n                                    className={\" circlesmall circlebutton mr5 flex flexjustifycenter clickable \" + (this.state.isTraining ? \"  disabled\" : \"\") + \" \" + (this.state.modelStale ? \" pulse\" : \"\")}>\n                                    <Reset16 style={{ fill: \"white\" }} className=\"unselectable unclickable\" />\n\n                                </div>\n                                <div className=\" displayblock smalldesc textaligncenter pt5 \"> Initialize  </div>\n                            </div>\n\n                        </div>\n\n                    </div>\n\n                    <div className=\" iblock \">\n                        <div\n                            onClick={this.trainButtonClick.bind(this)}\n                            className={(\"iblock circlelarge circlebutton mr5 flexcolumn flex flexjustifycenter clickable \") + (this.state.modelStale ? \" disabled\" : \"\")}>\n                            {!this.state.isTraining && <PlayFilledAlt16 style={{ fill: \"white\" }} className=\"unselectable unclickable\" />}\n                            {this.state.isTraining && <PauseFilled16 style={{ fill: \"white\" }} className=\"unselectable unclickable\" />}\n                        </div>\n                        <div className=\"smalldesc textaligncenter pt5 pb5 \"> Train &nbsp; </div>\n                    </div>\n\n                    <div ref className=\"iblock  mr10\">\n                        <div ref=\"activeloaderdiv\" className=\"resetbox\" style={{opacity: (this.state.isTraining || this.state.isCreating) ? 1:0, width: (this.state.isTraining || this.state.isCreating)  ?  \"34px\": \"0px\"  }} >\n                            <Loading\n                                className=\" \"\n                                active={true}\n                                small={true}\n                                withOverlay={false}\n                            > </Loading>\n                        </div>\n\n                    </div>\n\n\n\n                </div>\n            </div>\n        )\n        let configBar = (\n            <div style={{ zIndex: 100 }} className=\"w100   unselectable greyhighlight  flex flexjustifyleft flexjustifycenter  \">\n                <div className=\"pl10 pt10 pr10 pb5  iblock\">\n                    <div className=\"iblock mr10\">\n                        <div className=\"mediumdesc pb7 pt5\"> Steps <span className=\"boldtext\"> {this.state.numSteps} </span>  - {this.state.CumulativeSteps}  </div>\n                        <Dropdown\n                            id=\"epochsdropdown\" \n                            label=\"Steps\"\n                            items={this.stepOptions}\n                            initialSelectedItem={this.stepOptions[0]}\n                            itemToString={item => (item ? item.text : \"\")}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                    <div className=\"iblock mr10\">\n                        <div className=\"mediumdesc pb7 pt5\"> Batchsize <span className=\"boldtext\"> {this.state.batchSize} </span> </div>\n                        <Dropdown\n                            id=\"batchsizedropdown\"\n                            label=\"Batch Size\"\n                            items={this.batchSizeOptions}\n                            initialSelectedItem={this.batchSizeOptions[3]}\n                            itemToString={item => (item ? item.text : \"\")}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                    <div className=\"iblock mr10\">\n                        <div className=\"mediumdesc pb7 pt5\"> Learning Rate <span className=\"boldtext\"> {this.state.learningRate}</span>  </div>\n                        <Dropdown\n                            id=\"learningratedropdown\"\n                            label=\"Learning Rate\"\n                            items={this.learningRateOptions}\n                            itemToString={item => (item ? item.text : \"\")}\n                            initialSelectedItem={this.learningRateOptions[0]}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                    <div className=\"iblock mr10\">\n                        <div className=\"mediumdesc pb7 pt5\"> Regularlizer <span className=\"boldtext\"> {this.state.regularizer}</span> </div>\n                        <Dropdown\n                            id=\"regularizeerdropdown\"\n                            label=\"Regularizer\"\n                            items={this.regularizerOptions}\n                            itemToString={item => (item ? item.text : \"\")}\n                            initialSelectedItem={this.regularizerOptions[this.selectedRegularizer]}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                    <div style={{ zIndex: 5000 }} className=\"iblock mr10 \">\n                        <div className=\"mediumdesc pb7 pt5\"> Optimizer <span className=\"boldtext\"> {this.state.optimizer} </span> </div>\n                        <Dropdown\n                            style={{ zIndex: 100 }}\n                            id=\"optimizerdropdown\"\n                            label=\"Optimizer\"\n                            items={this.optimizerOptions}\n                            itemToString={item => (item ? item.text : \"\")}\n                            initialSelectedItem={this.optimizerOptions[this.selectedOptimizer]}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                     \n                    <div className=\"iblock mr10 borderleftdash pl10 \">\n                    {/* <div className=\"configsectiontitle smalldesc iblock mr10\">  Dataset </div> */}\n                        <div className=\"iblock\">\n                        <div className=\"mediumdesc pb7 pt5\">Train Size <span className=\"boldtext\"> {this.state.trainDataShape[0]} </span>  </div>\n                        <Dropdown\n                            id=\"trainingdatadropdown\"\n                            label=\"Training Data\"\n                            items={this.trainingDataOptions}\n                            initialSelectedItem={this.trainingDataOptions[this.selectedTrainDataOption]}\n                            itemToString={item => (item ? item.text : \"\")}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                        </div>\n                    </div>\n\n                    <div className=\"iblock mr10\">\n                        <div className=\"mediumdesc pb7 pt5\"> Abnormal % <span className=\"boldtext\"> {this.state.abnormalPercentage} </span> </div>\n                        <Dropdown\n                            id=\"abnormalpercentagedatadropdown\"\n                            label=\"Abnormal %\"\n                            items={this.abnormalPercentageOptions}\n                            initialSelectedItem={this.abnormalPercentageOptions[this.selectedAbnormalPercentage]}\n                            itemToString={item => (item ? item.text : \"\")}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                    <div className=\"iblock mr10\">\n                        <div className=\"mediumdesc pb7 pt5\">Test Size <span className=\"boldtext\"> {this.state.testDataShape[0]} </span> </div>\n                        <Dropdown\n                            id=\"testdatadropdown\"\n                            label=\"Test Data\"\n                            items={this.testDataOptions}\n                            itemToString={item => (item ? item.text : \"\")}\n                            initialSelectedItem={this.testDataOptions[this.selectedTestDataOption]}\n                            onChange={this.updateModelParam.bind(this)}\n                        />\n                    </div>\n\n                \n                    <div className=\"   pt5 pb3\">  \n                        {this.state.modelStale && <div className=\"smallblueball pulse iblock\"></div>}\n                        {(this.state.modelStale && this.state.CumulativeSteps === 0 )&& <span className=\"mediumdesc\"> Select model parameters and click <span className=\"boldtext \"> initialize </span> to compile model.</span>}\n                        {(this.state.modelStale && this.state.CumulativeSteps > 0) && <span className=\"mediumdesc\"> Model configuration has changed. Click <span className=\"boldtext \"> initialize </span> to recompile model.</span>}\n                    { !this.state.modelStale && <span className=\"mediumdesc\"> Model compiled based on selected parameters. Ready to <span className=\"boldtext\"> train </span>. </span> }\n                    </div>\n                </div>\n            </div>\n        )\n \n        if (this.state.encodedData[0]) {\n            // console.log(this.state.encodedData[0].x);\n            this.firstEncode = this.state.encodedData[0].x + this.state.encodedData[1].x\n        }\n        let compBoxSize = 0\n        if (this.refs[\"composemodelbox\"]) {\n            compBoxSize = this.refs[\"composemodelbox\"].offsetWidth\n        }\n        // console.log(compBoxSize);\n        \n        let modelComposerBlock = (\n            <div className=\"composermaindiv\">\n                 {/* // Model Composer  */}\n                {this.state.showModelComposer &&\n                        <div className=\" mr10 \">\n                            <div>\n                                <div className=\"charttitle mb5 \">\n                                    Model Composer\n                            </div>\n                                <div>\n                                    <ComposeModel\n                                        hiddenDims={this.state.hiddenDim}\n                                        latentDim={[this.state.latentDim]}\n                                        isTraining={this.state.isTraining}\n                                        updateModelDims={this.updateModelDims}\n                                        adv={this.state.showAdvanced + \"b\" + this.state.showIntroduction + chartState + this.firstEncode + \"-\" + compBoxSize}\n                                    />\n                                </div>\n                            </div>\n                        </div>}\n            </div>\n        )\n\n        let lossChartBlock = (\n            <div>\n                {this.state.showLossChart && <div className=\"iblock mr10  h100 \" > \n                                    <div>\n                                        <div className=\"charttitle \">\n                                            Train Loss\n                                        </div>\n\n                        <div>\n                        <div className={\"positionrelative h100 \" + (this.state.trainMetrics.length <= 0 ? \" \" : \"\")} style={{ width: this.chartWidth, height: this.chartHeight }}>\n                                {this.state.trainMetrics.length <= 0 &&\n                                    <div className=\"notrainingdata\">  No training loss data yet </div>\n                                }\n                                 \n                                    {this.state.trainMetrics.length > 0 &&\n                                                    <LossChart\n                                                        data={{\n                                                            data: this.state.trainMetrics,\n                                                            chartWidth: this.chartWidth,\n                                                            chartHeight: this.state.lossChartHeight,\n                                                            epoch: this.state.CumulativeSteps\n                                                        }}\n\n                                        ></LossChart>\n                                }\n                                </div>\n                                        </div>\n                                    </div> \n                        </div>}\n            </div>\n        )\n\n        let rocChartBlock = (\n            <div>\n                {this.state.showRocChart && <div className=\"iblock mr10\">\n                            {this.state.rocData.length > 0 &&\n                                <div>\n                                    <div className=\"charttitle \">\n                                        ROC Curve [ AUC : {this.state.auc.toFixed(2)} ]\n                                    </div>\n\n                                    <div>\n                                        <ROCChart\n                                            data={{\n                                                chartWidth: this.chartWidth,\n                                                chartHeight: this.state.lossChartHeight,\n                                                data: this.state.rocData,\n                                                isTraining: this.state.isTraining,\n                                                epoch: this.state.CumulativeSteps,\n                                                auc: this.state.auc\n\n                                            }} \n                                        ></ROCChart>\n                                    </div>\n                                </div>\n                            }\n                        </div>}\n            </div>\n        )\n\n        let mseHistogramBlock = (\n            <div>\n                {this.state.showMseHistogram && <div className=\"iblock mr10 \">\n                            {this.state.mseData.length > 0 && \n                                <div>\n                                    <div className=\"charttitle\"> Histogram of Mean Square Error </  div>\n\n                                    <div>\n                                        <HistogramChart\n                                            data={{\n                                                data: this.state.mseData,\n                                                chartWidth: this.chartWidth,\n                                                chartHeight: this.state.lossChartHeight,\n                                                epoch: this.state.CumulativeSteps,\n                                                threshold: this.state.bestMetric.threshold\n                                            }}\n                                        ></HistogramChart>\n                                    </div>\n                                </div> \n                            }\n                        </div>}\n            </div>\n        )\n\n        let bottleneckScatterPlotBlock = (\n            <div>\n                 {this.state.showBottleneckScatterPlot && <div className=\"iblock mr10  \">\n                            {this.state.encodedData.length > 0 &&\n\n                                <div>\n                                    <div className=\"charttitle\"> Bottleneck Scatterplot </  div>\n\n                                    <div>\n                                        <ScatterPlot\n                                            data={{\n                                                data: this.state.encodedData,\n                                                chartWidth: this.chartWidth,\n                                                chartHeight: this.state.lossChartHeight,\n                                                epoch: this.state.CumulativeSteps\n                                            }}\n\n                                        ></ScatterPlot>\n                                    </div>\n                                </div>\n\n                            }\n                        </div>}\n            </div>\n        )\n\n        let modelMetricsBlock = (\n            <div className=\"flex  w100 pr10   \"> \n                    {(this.state.bestMetric && this.state.showModelEvaluationMetrics) &&\n\n                        <div className={\"iblock perfmetrics w100 \" + (this.state.isTraining ? \" disabled \" : \" \")}>\n                            <div className=\"charttitle mb5 \">\n                                Model Evaluation Metrics\n                            </div>\n                            <div className=\"mb5 greyhighlight p10 touchnoscroll\">\n                                <Slider\n                                    className=\"w100 border\"\n                                    min={0} //{(this.state.minThreshold.toFixed(4) * 1)}\n                                    max={100}//{(this.state.maxThreshold.toFixed(4) * 1)}\n                                    step={2}\n                                    minLabel={\"%\"}\n                                    maxLabel={\"%\"}\n                                    value={((this.state.bestMetric.threshold - this.state.minThreshold) / (this.state.maxThreshold - this.state.minThreshold)) * 100}\n                                    stepMuliplier={10}\n                                    disabled={this.state.isTraining ? true : false}\n                                    labelText={\"Threshold \" + (this.state.bestMetric.threshold).toFixed(4) + \" [ \" + (((this.state.bestMetric.threshold - this.state.minThreshold) / (this.state.maxThreshold - this.state.minThreshold)) * 100).toFixed(0) + \" % ] \"}\n                                    hideTextInput={true}\n                                    onChange={this.updateThreshold.bind(this)}\n                                />\n                            </div>\n                            <div className=\"flex\">\n                                <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.acc * 100)) }} className=\"metricguage mb5  greyhighlight  textaligncenter mr5 flex5\" >\n                                    <div className=\"metricvalue textaligncenter  rad4\"> {(this.state.bestMetric.acc * 100).toFixed(2)}  %</div>\n                                    <div className=\"metricdesc mediumdesc p5\"> Best Accuracy </div>\n                                </div>\n                                <div style={{ borderLeftColor: percentToRGB((this.state.auc * 100)) }} className=\"metricguage mb5 greyhighlight  textaligncenter flex5\" >\n                                    <div className=\"metricvalue textaligncenter  rad4\"> {(this.state.auc).toFixed(2)} </div>\n                                    <div className=\"metricdesc mediumdesc p5\"> AUC </div>\n                                </div>\n                            </div>\n                            <div className=\"mb5 flex\">\n\n                                <div style={{ borderLeftColor: percentToRGB(100 - (this.state.bestMetric.fpr * 100)) }} className=\"metricguage flex5 mr5  greyhighlight  textaligncenter\">\n                                    <div className=\"metricvalue textaligncenter\"> {(this.state.bestMetric.fpr * 100).toFixed(2)}  % </div>\n                                    <div className=\"metricdesc mediumdesc p5\"> False Positive Rate </div>\n                                </div>\n                                <div style={{ borderLeftColor: percentToRGB(100 - (this.state.bestMetric.fnr * 100)) }} className=\"metricguage flex5   greyhighlight  textaligncenter\">\n                                    <div className=\"metricvalue\"> {(this.state.bestMetric.fnr * 100).toFixed(2)} % </div>\n                                    <div className=\"metricdesc displayblock mediumdesc p5\"> False Negative Rate </div>\n                                </div>\n\n                            </div>\n                            <div className=\"flex\">\n                                <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.tpr * 100)) }} className=\"metricguage flex5  mr5 greyhighlight  textaligncenter\">\n                                    <div className=\"metricvalue\"> {(this.state.bestMetric.tpr * 100).toFixed(2)} % </div>\n                                    <div className=\"metricdesc mr10 mediumdesc p5\"> True Positive Rate </div>\n                                </div>\n                                <div style={{ borderLeftColor: percentToRGB((this.state.bestMetric.tnr * 100)) }} className=\"metricguage flex5  greyhighlight  textaligncenter\">\n                                    <div className=\"metricvalue\"> {(this.state.bestMetric.tnr * 100).toFixed(2)} % </div>\n                                    <div className=\"metricdesc mediumdesc p5\"> True Negative Rate </div>\n                                </div>\n                            </div>\n\n                        </div>}\n\n                </div>\n        )\n  \n        return (\n            <div className=\"maintrainbox\">  \n                {/* {this.state.showWarmingUp && <div className=\"\">\n                    <div className=\"flex mt10 mr10 \">\n                        <div className=\"iblock  flexjustifycenter\" ref=\"activeloaderdiv\" >\n                            <div className=\"loadcircle iblock\"></div>\n                                \n                        </div> \n                       \n                        <div className=\"iblock pt3 pl5 h100 \"> Initializing model ...</div> \n                    </div>\n                </div>} */}\n\n                {/* show advanced options pannel */}\n                <div style={{ zIndex: 100 }} onClick={this.toggleIntroDrawer.bind(this)} className=\"unselectable mt10 p10 clickable  flex greymoreinfo\">\n                    <div className=\"iblock flexfull minwidth485\">\n                        <strong>\n                            {!this.state.showIntroduction && <span>&#x25BC;  </span>} {this.state.showIntroduction && <span>&#x25B2;  </span>}\n                        </strong>\n                        Introduction\n                    </div>\n                    <div className=\"iblock   \">\n                        <div className=\"iblock mr5\"> <span className=\"boldtext\"> {} </span></div>\n                        <div className=\"iblock\">\n                            <div className=\"smalldesc\"> Overview of how it works!</div>\n                        </div>\n                    </div>\n\n                </div>\n\n\n                {(this.state.showIntroduction) &&\n                    <div className=\"mynotif h100 lh10 mt10 lightbluehightlight maxh16  mb10\">\n                        <div className=\"boldtext\"> Train an Autoencoder for Anomaly Detection </div>\n                        <div>\n                            <a href=\"https://en.wikipedia.org/wiki/Autoencoder\" target=\"_blank\" rel=\"noopener noreferrer\">\n                                Autoencoders</a> are neural networks which learn to reconstruct input data. We can leverage this property to detect anomalies.\n                                <div className=\"circlenumber iblock textaligncenter\"> 1 </div>  <span className=\"boldtext\"> Initialize . </span> Select model parameters\n                (number of layers, batchsize, learning rate, regularizer etc) and then initialize (compile) the model.\n                        <div className=\"circlenumber iblock textaligncenter\"> 2 </div>  <span className=\"boldtext\"> Train. </span> This trains the autoencoder using normal data \n                        samples from the ECG5000 dataset.  Training the model on a dataset that consists of mainly normal data (an assumption that holds for most anomaly use cases), \n                        the model learns to reconstruct only normal data samples with very little reconstruction error. \n                        To mirror your use case conditions, you can specify the percentage of abnormal samples \n                        to include in the training data set and observe how it affects accuracy.\n                        <div className=\"circlenumber iblock textaligncenter\"> 3 </div>  <span className=\"boldtext\"> Evaluate. </span> \n                        At each training step, visualize the reconstruction error (mse) generated for each sample in the test dataset. Observe that mse is higher\n                        for abnormal samples compared to abnormal samples. We can select a threshold and flag samples with an mse > threshold as anomalies. \n                        Model performance can then be evaluated using metrics such has AUC, TPR, FPR; also observe how these metrics vary with different\n                        choices of threshold.\n         \n                     </div>\n\n                    </div>}\n\n                {/* show advanced options pannel */}\n                <div style={{ zIndex: 100 }} onClick={this.toggleAdvancedDrawer.bind(this)} className=\"unselectable mt10 p10 clickable  flex greymoreinfo\">\n                    <div className=\"iblock flexfull minwidth485\">\n                        <strong>\n                            {!this.state.showAdvanced && <span>&#x25BC;  </span>} {this.state.showAdvanced && <span>&#x25B2;  </span>}\n                        </strong>\n                        Select model configuration and visualization charts.\n                    </div>\n                    <div className=\"iblock   \">\n                        <div className=\"iblock mr5\"> <span className=\"boldtext\"> {} </span></div>\n                        <div className=\"iblock\">\n                            <div className=\"smalldesc\"> \n                                \n                                {this.state.hiddenDim.length} Layer Autoencoder\n                                \n                            </div>\n                        </div>\n                    </div>\n\n                </div>\n                \n\n                {(this.state.showAdvanced) &&\n                    <div className=\" modelconfigdiv p10 \"> \n\n                        <div className=\"flex flexwrap \">\n                            <div className=\"flexwrapitem\">\n                                {trainResetButtons}\n                            </div>\n                            <div className=\"flexwrapitem flexfull \">\n                                {configBar}\n                        </div>\n                       \n                        </div>\n\n                        <div className=\"pl10 pt5 pr10 pb5 greyborder mt10\">\n                            <div className=\"boldtext  iblock mr5\">\n                                {/* <div className=\"iblock \"> Charts </div> */}\n                                <div className=\"iblock boldtext  \">\n                                    <Tooltip\n                                        direction=\"right\"\n                                        triggerText=\"Select Charts\"\n                                    >\n                                        <div className=\"tooltiptext\">\n                                            Add/Remove charts that visualize the state of the model as training progresses.\n                                            For example, the Training Loss chart shows the \"loss\" or error of the model as training progresses.\n                                        </div>\n\n                                    </Tooltip>\n                                </div>\n\n                            </div>\n                            {showCheckBoxes}\n                        </div>\n\n                    </div>\n                }\n                <div ref=\"glowbar\" className={\"glowbar w0 \"} style={{ width: Math.floor((this.currentSteps / this.state.numSteps) * 100) + \"%\" }}></div>\n\n\n\n                {/* start of top bar */}\n\n\n\n\n                {/* end of top bar */}\n\n\n\n                {/* <div className={\"mb5 \" + (this.state.isTraining ? \" rainbowbar\" : \" displaynone\")}></div> */}\n\n                <div ref=\"chartcontainer\" className=\"flex chartcontainer flexwrap mt10\">\n                    <div ref=\"composemodelbox\" action=\"composer\"  className={\"traincomposerdiv flexwrapitem \" + (this.state.showModelComposer ? \" flex40\":\"\")}> {modelComposerBlock} </div>\n                    <div ref=\"modelevalbox\" action=\"metrics\" className={\"flexwrapitem \" + (this.state.showModelEvaluationMetrics ? \" flexfull\":\"\")}> {modelMetricsBlock} </div>\n                    <div ref=\"lossbox1\" action=\"loss\"  className=\"  flexwrapitem \"> { lossChartBlock} </div>\n                    <div action=\"mse\" className=\"flexwrapitem  \"> {mseHistogramBlock} </div>\n                    \n                    {(this.state.rocData.length > 0 && this.state.encodedData.length >0) &&\n                        <div className=\"   iblock flex20\">\n                            <div action=\"roc\" className=\"flexwrapitem  iblock \"> {rocChartBlock} </div>\n                            <div action=\"bottleneck\"  className=\"flexwrapitem   iblock\"> {bottleneckScatterPlotBlock} </div>\n\n                         </div>\n                    }\n                </div>\n                \n                <div> \n                   {/* {this.hideLoss && <div ref=\"lossbox1d\" action=\"loss\"  className=\"flexwrapitem iblock\"> {lossChartBlock} </div>} */}\n                   \n                    \n                </div>\n\n               \n                \n                {\n                     \n                    <div className=\"mediumdesc p10\"> \n                       Textures in use - Flaot32 Capable ? {this.state.floatCapable.toString()} | {this.state.floatEnabled.toString()}\n                    </div>\n                }\n                <br />\n                <br />\n                <br />\n\n            </div >\n        );\n    }\n}\n\nexport default Train;","import React, { Component } from \"react\";\n// import { Reset16, PlayFilledAlt16 } from '@carbon/icons-react';\nimport DrawSignal from \"./../drawsignal/DrawSignal\"\n// import { computeAccuracyGivenThreshold } from \"./../helperfunctions/HelperFunctions\"\n// import * as _ from \"lodash\"\nimport \"./faq.css\"\n\nclass Faq extends Component {\n\n    constructor(props) {\n        super(props)\n\n\n        this.state = {\n            metricData: []\n        }\n    }\n\n\n\n    componentDidMount() {\n\n\n\n\n    }\n    render() {\n\n\n\n\n\n        return (\n            <div>\n\n\n                <div>FAQ</div>\n                <DrawSignal\n                    width={600}\n                    height={300}\n\n                ></DrawSignal>\n\n                <br />\n                <br />\n                <div> FAQ </div>\n\n                <div> Training Parameters </div>\n                <div> All trainining parameters are selected as specified.\n                    For regularization, kernel regularization (reduces the size of the weights) is implemented (vs activity regularization)\n                    This is applied to all layers in the model.\n                    The regularization rate is set as same as the learning rate.\n\n                </div>\n            </div >\n        );\n    }\n}\n\nexport default Faq;","import React, { Component } from \"react\";\nimport {\n    Route,\n    HashRouter,\n\n} from \"react-router-dom\";\n\n// import { InlineNotification } from 'carbon-components-react';\n\n\nimport \"./template.css\"\n\n// import Sidebar from \"./Sidebar\";\nimport AppHeader from \"./header/AppHeader\";\nimport Footer from \"./footer/Footer\";\nimport Viz from \"./viz/Viz\";\nimport Train from \"./train/Train\"\nimport ComposeModel from \"./composemodel/ComposeModel\"\nimport Faq from \"./faq/Faq\"\n\nimport { createBrowserHistory } from 'history';\n\n\n// ReactGA.initialize(\"UA-131578973-1\")\nconst history = createBrowserHistory({\n    basename: \"\", // The base URL of the app (see below)\n    forceRefresh: false, // Set true to force full page refreshes\n    keyLength: 6, // The length of location.key\n    // A function to use to confirm navigation with the user (see below)\n    getUserConfirmation: (message, callback) => callback(window.confirm(message))\n});\n// history.listen(location => {\n//     ReactGA.set({ page: location.hash })\n//     ReactGA.pageview(location.hash)\n//     // console.log(location.pathname, location.hash)\n// })\n\nlet linkHolder = {}\n\nfunction updateLh(location) {\n\n    if (location.hash in linkHolder) {\n        linkHolder[location.hash] = linkHolder[location.hash] + 1\n    } else {\n        linkHolder[location.hash] = 0\n    }\n\n}\n\nhistory.listen(location => {\n    updateLh(location)\n});\n\n\nclass Main extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n        }\n\n        // console.log(window.location)\n        updateLh(window.location)\n    }\n\n    componentDidMount() {\n        // ReactGA.pageview(window.location.hash)\n        // document.title = \"Image Analysis Explorer | Explore Convolutional Neural Nets for Imagee Analysis\";\n    }\n\n\n\n\n\n\n    render() {\n        const Composer = (props) => {\n            return (\n                <ComposeModel\n                    hiddenDims={[6, 5, 4, 3]}\n                    latentDim={[4]}\n                    isTraining={false}\n\n                />\n            );\n        }\n\n        return (\n            <HashRouter>\n                <AppHeader></AppHeader>\n\n                <div className=\"container-fluid p10\">\n                    <Route exact path=\"/\" component={Viz} />\n                    <Route exact path=\"/train\" component={Train} />\n                    <Route exact path=\"/compose\" component={Composer} />\n                    <Route exact path=\"/faq\" component={Faq} />\n\n                    <div id=\"notificatiionbox\" className=\"notificationtopright p5  \">\n\n                    </div>\n                </div>\n                <div id=\"footer\"> <Footer /> </div>\n            </HashRouter>\n\n        );\n    }\n}\n\nexport default Main;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Main from \"./components/Main\";\nimport * as serviceWorker from './serviceWorker';\n\nimport \"./components/template.scss\"\n// import 'bootstrap/dist/css/bootstrap.css';\n\nReactDOM.render(\n    <Main />,\n    document.getElementById(\"root\")\n);\n\nserviceWorker.register()"],"sourceRoot":""}